ë³‘ë ¬ Investigation Phase êµ¬í˜„ ê³„íš                      â”‚
     â”‚                                                         â”‚
     â”‚ ğŸ¯ ë¬¸ì œ í™•ì¸                                            â”‚
     â”‚                                                         â”‚
     â”‚ ë§ìŠµë‹ˆë‹¤! í˜„ì¬ êµ¬í˜„ì€ ìˆœì°¨ì (Sequential) êµ¬ì¡°ì…ë‹ˆë‹¤.    â”‚
     â”‚                                                         â”‚
     â”‚ í˜„ì¬ ì˜ëª»ëœ í”Œë¡œìš°:                                     â”‚
     â”‚                                                         â”‚
     â”‚ Overview â†’ Location Exploration (ì™„ë£Œ í•„ìˆ˜) â†’ Suspect   â”‚
     â”‚ Interrogation â†’ Submission                              â”‚
     â”‚ - ì¥ì†Œ íƒìƒ‰ì„ ëë‚´ì•¼ë§Œ ìš©ì˜ì ì‹¬ë¬¸ ê°€ëŠ¥                 â”‚
     â”‚ - í•œ ë²ˆ ìš©ì˜ì ì‹¬ë¬¸ìœ¼ë¡œ ë„˜ì–´ê°€ë©´ ë‹¤ì‹œ ì¥ì†Œë¡œ ëŒì•„ê°ˆ ìˆ˜  â”‚
     â”‚ ì—†ìŒ                                                    â”‚
     â”‚ - ë³‘ë ¬ íƒìƒ‰ ë¶ˆê°€ëŠ¥ âŒ                                    
â”‚
     â”‚                                                         â”‚
     â”‚ ì˜¬ë°”ë¥¸ í”Œë¡œìš° (ë‹¹ì´ˆ ê¸°íš):                              â”‚
     â”‚                                                         â”‚
     â”‚ Overview â†’ Investigation Phase (ì¥ì†Œâ†”ìš©ì˜ì ììœ ë¡­ê²Œ    â”‚
     â”‚ ì „í™˜) â†’ Submission                                      â”‚
     â”‚ - Investigation Phase ë‚´ì—ì„œ íƒ­ìœ¼ë¡œ ì „í™˜                â”‚
     â”‚ - ì›í•˜ëŠ” ë§Œí¼ ì™”ë‹¤ê°”ë‹¤ ê°€ëŠ¥                             â”‚
     â”‚ - ë³‘ë ¬ íƒìƒ‰ ê°€ëŠ¥ âœ…                                      
â”‚
     â”‚                                                         â”‚
     â”‚ ---                                                     â”‚
     â”‚ ğŸ“‹ ìˆ˜ì • ê³„íš                                            â”‚
     â”‚                                                         â”‚
     â”‚ 1. ìƒˆ ì»´í¬ë„ŒíŠ¸ ìƒì„±: InvestigationScreen.tsx            â”‚
     â”‚                                                         â”‚
     â”‚ ìœ„ì¹˜: src/client/components/InvestigationScreen.tsx     â”‚
     â”‚                                                         â”‚
     â”‚ êµ¬ì¡°:                                                   â”‚
     â”‚ interface InvestigationScreenProps {                    â”‚
     â”‚   caseId: string;                                       â”‚
     â”‚   userId: string;                                       â”‚
     â”‚   caseData: CaseData;                                   â”‚
     â”‚   suspects: Suspect[];                                  â”‚
     â”‚   onGoToSubmission: () => void;                         â”‚
     â”‚ }                                                       â”‚
     â”‚                                                         â”‚
     â”‚ // íƒ­ íƒ€ì…                                              â”‚
     â”‚ type InvestigationTab = 'locations' | 'suspects';       â”‚
     â”‚                                                         â”‚
     â”‚ function InvestigationScreen({                          â”‚
     â”‚   caseId, userId, caseData, suspects, onGoToSubmission  â”‚
     â”‚ }: InvestigationScreenProps) {                          â”‚
     â”‚   const [activeTab, setActiveTab] =                     â”‚
     â”‚ useState<InvestigationTab>('locations');                â”‚
     â”‚                                                         â”‚
     â”‚   return (                                              â”‚
     â”‚     <div className="investigation-screen">              â”‚
     â”‚       {/* Header with title and submission button */}   â”‚
     â”‚       <Header onGoToSubmission={onGoToSubmission} />    â”‚
     â”‚                                                         â”‚
     â”‚       {/* Tab Navigation */}                            â”‚
     â”‚       <TabNavigation                                    â”‚
     â”‚         activeTab={activeTab}                           â”‚
     â”‚         onTabChange={setActiveTab}                      â”‚
     â”‚         tabs={[                                         â”‚
     â”‚           { id: 'locations', label: 'ğŸ—ºï¸ ì¥ì†Œ íƒìƒ‰',    â”‚ 
     â”‚ icon: 'ğŸ”' },                                           â”‚
     â”‚           { id: 'suspects', label: 'ğŸ‘¤ ìš©ì˜ì ì‹¬ë¬¸',    â”‚
     â”‚ icon: 'ğŸ’¬' }                                            â”‚
     â”‚         ]}                                              â”‚
     â”‚       />                                                â”‚
     â”‚                                                         â”‚
     â”‚       {/* Content based on active tab */}               â”‚
     â”‚       {activeTab === 'locations' && (                   â”‚
     â”‚         <LocationExplorerSection                        â”‚
     â”‚           caseId={caseId}                               â”‚
     â”‚           userId={userId}                               â”‚
     â”‚           locations={caseData.locations || []}          â”‚
     â”‚         />                                              â”‚
     â”‚       )}                                                â”‚
     â”‚                                                         â”‚
     â”‚       {activeTab === 'suspects' && (                    â”‚
     â”‚         <SuspectInterrogationSection                    â”‚
     â”‚           caseId={caseId}                               â”‚
     â”‚           userId={userId}                               â”‚
     â”‚           suspects={suspects}                           â”‚
     â”‚         />                                              â”‚
     â”‚       )}                                                â”‚
     â”‚     </div>                                              â”‚
     â”‚   );                                                    â”‚
     â”‚ }                                                       â”‚
     â”‚                                                         â”‚
     â”‚ íŠ¹ì§•:                                                   â”‚
     â”‚ - 2ê°œ íƒ­: ì¥ì†Œ íƒìƒ‰ / ìš©ì˜ì ì‹¬ë¬¸                       â”‚
     â”‚ - ììœ ë¡­ê²Œ ì „í™˜ ê°€ëŠ¥                                    â”‚
     â”‚ - ê°™ì€ actionPoints ê³µìœ                                 â”‚
     â”‚ - ê°™ì€ playerState ê³µìœ                                  â”‚
     â”‚                                                         â”‚
     â”‚ ---                                                     â”‚
     â”‚ 2. LocationExplorerSection ë¶„ë¦¬                         â”‚
     â”‚                                                         â”‚
     â”‚ ê¸°ì¡´ LocationExplorerScreenì—ì„œ:                        â”‚
     â”‚ - onNavigateToSuspects prop ì œê±°                        â”‚
     â”‚ - "ìš©ì˜ì ì‹¬ë¬¸ìœ¼ë¡œ" ë²„íŠ¼ ì œê±°                           â”‚
     â”‚ - ìˆœìˆ˜í•˜ê²Œ ì¥ì†Œ íƒìƒ‰ ê¸°ëŠ¥ë§Œ                             â”‚
     â”‚                                                         â”‚
     â”‚ ìˆ˜ì • í›„:                                                â”‚
     â”‚ // onNavigateToSuspects prop ì œê±°                       â”‚
     â”‚ function LocationExplorerSection({                      â”‚
     â”‚   caseId,                                               â”‚
     â”‚   userId,                                               â”‚
     â”‚   locations,                                            â”‚
     â”‚ }: {                                                    â”‚
     â”‚   caseId: string;                                       â”‚
     â”‚   userId: string;                                       â”‚
     â”‚   locations: Location[];                                â”‚
     â”‚ }) {                                                    â”‚
     â”‚   // ... ê¸°ì¡´ ë¡œì§ ìœ ì§€                                 â”‚
     â”‚   // "ìš©ì˜ì ì‹¬ë¬¸ìœ¼ë¡œ" ë²„íŠ¼ë§Œ ì œê±°                      â”‚
     â”‚ }                                                       â”‚
     â”‚                                                         â”‚
     â”‚ ---                                                     â”‚
     â”‚ 3. SuspectInterrogationSection ìƒì„±                     â”‚
     â”‚                                                         â”‚
     â”‚ ê¸°ì¡´ App.tsxì˜ investigation ë¡œì§ì„ ë¶„ë¦¬:               â”‚
     â”‚ function SuspectInterrogationSection({                  â”‚
     â”‚   caseId,                                               â”‚
     â”‚   userId,                                               â”‚
     â”‚   suspects,                                             â”‚
     â”‚ }: {                                                    â”‚
     â”‚   caseId: string;                                       â”‚
     â”‚   userId: string;                                       â”‚
     â”‚   suspects: Suspect[];                                  â”‚
     â”‚ }) {                                                    â”‚
     â”‚   const { selectedSuspect, selectSuspect } =            â”‚
     â”‚ useSuspect(suspects);                                   â”‚
     â”‚   const { messages, sendMessage, loading } = useChat({  â”‚
     â”‚     suspectId: selectedSuspect?.id || '',               â”‚
     â”‚     userId,                                             â”‚
     â”‚     enabled: !!selectedSuspect,                         â”‚
     â”‚   });                                                   â”‚
     â”‚                                                         â”‚
     â”‚   return (                                              â”‚
     â”‚     <div>                                               â”‚
     â”‚       <SuspectPanel                                     â”‚
     â”‚         suspects={suspects}                             â”‚
     â”‚         selectedSuspectId={selectedSuspect?.id}         â”‚
     â”‚         onSelectSuspect={selectSuspect}                 â”‚
     â”‚       />                                                â”‚
     â”‚                                                         â”‚
     â”‚       {selectedSuspect && (                             â”‚
     â”‚         <ChatInterface                                  â”‚
     â”‚           suspectName={selectedSuspect.name}            â”‚
     â”‚           messages={messages}                           â”‚
     â”‚           onSendMessage={sendMessage}                   â”‚
     â”‚           loading={loading}                             â”‚
     â”‚         />                                              â”‚
     â”‚       )}                                                â”‚
     â”‚     </div>                                              â”‚
     â”‚   );                                                    â”‚
     â”‚ }                                                       â”‚
     â”‚                                                         â”‚
     â”‚ ---                                                     â”‚
     â”‚ 4. App.tsx ìˆ˜ì •                                         â”‚
     â”‚                                                         â”‚
     â”‚ ë³€ê²½ ì‚¬í•­:                                              â”‚
     â”‚                                                         â”‚
     â”‚ A. GameScreen íƒ€ì… ìˆ˜ì •:                                â”‚
     â”‚ // 'location-exploration' ì œê±°                          â”‚
     â”‚ type GameScreen =                                       â”‚
     â”‚   | 'loading'                                           â”‚
     â”‚   | 'intro'                                             â”‚
     â”‚   | 'case-overview'                                     â”‚
     â”‚   | 'investigation'  // í†µí•©ëœ Investigation Phase      â”‚
     â”‚   | 'submission'                                        â”‚
     â”‚   | 'results';                                          â”‚
     â”‚                                                         â”‚
     â”‚ B. í•¸ë“¤ëŸ¬ ë‹¨ìˆœí™”:                                       â”‚
     â”‚ const handleStartInvestigation = useCallback(() => {    â”‚
     â”‚   setCurrentScreen('investigation');  // ë°”ë¡œ           â”‚
     â”‚ investigationìœ¼ë¡œ                                       â”‚
     â”‚ }, []);                                                 â”‚
     â”‚                                                         â”‚
     â”‚ // handleGoToSuspectInterrogation ì œê±° (ë” ì´ìƒ í•„ìš”    â”‚
     â”‚ ì—†ìŒ)                                                   â”‚
     â”‚                                                         â”‚
     â”‚ C. ë Œë”ë§ ë¡œì§ êµì²´:                                    â”‚
     â”‚ // 'location-exploration' í™”ë©´ ì œê±°                     â”‚
     â”‚ // 'investigation' í™”ë©´ì„ InvestigationScreenìœ¼ë¡œ êµì²´  â”‚
     â”‚                                                         â”‚
     â”‚ if (currentScreen === 'investigation' && caseData) {    â”‚
     â”‚   return (                                              â”‚
     â”‚     <InvestigationScreen                                â”‚
     â”‚       caseId={caseData.id}                              â”‚
     â”‚       userId={userId}                                   â”‚
     â”‚       caseData={caseData}                               â”‚
     â”‚       suspects={suspects}                               â”‚
     â”‚       onGoToSubmission={handleGoToSubmission}           â”‚
     â”‚     />                                                  â”‚
     â”‚   );                                                    â”‚
     â”‚ }                                                       â”‚
     â”‚                                                         â”‚
     â”‚ ---                                                     â”‚
     â”‚ ğŸ“Š ìˆ˜ì •í•  íŒŒì¼ ëª©ë¡                                     â”‚
     â”‚                                                         â”‚
     â”‚ ìƒˆë¡œ ìƒì„± (2ê°œ):                                        â”‚
     â”‚                                                         â”‚
     â”‚ 1. src/client/components/InvestigationScreen.tsx - ë©”ì¸ â”‚
     â”‚ Investigation í™”ë©´                                      â”‚
     â”‚ 2. src/client/components/investigation/SuspectInterrogatâ”‚
     â”‚ ionSection.tsx - ìš©ì˜ì ì‹¬ë¬¸ ì„¹ì…˜                       â”‚
     â”‚                                                         â”‚
     â”‚ ìˆ˜ì • (3ê°œ):                                             â”‚
     â”‚                                                         â”‚
     â”‚ 1. src/client/App.tsx - í”Œë¡œìš° ë³€ê²½                     â”‚
     â”‚ 2. src/client/components/LocationExplorerScreen.tsx -   â”‚
     â”‚ onNavigateToSuspects ì œê±°                               â”‚
     â”‚ 3. src/client/types/index.ts - GameScreen íƒ€ì… ì—…ë°ì´íŠ¸ â”‚
     â”‚                                                         â”‚
     â”‚ ---                                                     â”‚
     â”‚ ğŸ® ìµœì¢… ì‚¬ìš©ì ê²½í—˜                                     â”‚
     â”‚                                                         â”‚
     â”‚ Before (ìˆœì°¨ì ):                                        â”‚
     â”‚                                                         â”‚
     â”‚ 1. Overview â†’ "ìˆ˜ì‚¬ ì‹œì‘"                               â”‚
     â”‚ 2. Location Exploration (ê°•ì œ)                          â”‚
     â”‚    - ì¥ì†Œë“¤ íƒìƒ‰                                        â”‚
     â”‚    - "ìš©ì˜ì ì‹¬ë¬¸ìœ¼ë¡œ" ë²„íŠ¼ í´ë¦­ (í•„ìˆ˜)                 â”‚
     â”‚ 3. Suspect Interrogation                                â”‚
     â”‚    - ìš©ì˜ì ì‹¬ë¬¸                                        â”‚
     â”‚    - ë‹¤ì‹œ ì¥ì†Œë¡œ ëª» ëŒì•„ê° âŒ                            
â”‚
     â”‚ 4. Submission                                           â”‚
     â”‚                                                         â”‚
     â”‚ After (ë³‘ë ¬):                                           â”‚
     â”‚                                                         â”‚
     â”‚ 1. Overview â†’ "ìˆ˜ì‚¬ ì‹œì‘"                               â”‚
     â”‚ 2. Investigation Phase                                  â”‚
     â”‚    [ì¥ì†Œ íƒìƒ‰] [ìš©ì˜ì ì‹¬ë¬¸] â† ììœ ë¡­ê²Œ ì „í™˜            â”‚
     â”‚                                                         â”‚
     â”‚    - ì¥ì†Œ íƒìƒ‰ â†’ ì¦ê±° ë°œê²¬                              â”‚
     â”‚    - ìš©ì˜ì ì‹¬ë¬¸ íƒ­ í´ë¦­                                â”‚
     â”‚    - ìš©ì˜ìì™€ ëŒ€í™”                                      â”‚
     â”‚    - ë‹¤ì‹œ ì¥ì†Œ íƒìƒ‰ íƒ­ í´ë¦­ âœ…                           
â”‚
     â”‚    - ë” ë§ì€ ì¦ê±° ìˆ˜ì§‘                                  â”‚
     â”‚    - ì›í•˜ëŠ” ë§Œí¼ ë°˜ë³µ                                   â”‚
     â”‚                                                         â”‚
     â”‚ 3. "ìˆ˜ì‚¬ ì™„ë£Œ" ë²„íŠ¼ â†’ Submission                        â”‚
     â”‚                                                         â”‚
     â”‚ ---                                                     â”‚
     â”‚ âœ… êµ¬í˜„ íš¨ê³¼                                             
â”‚
     â”‚                                                         â”‚
     â”‚ 1. ë‹¹ì´ˆ ê¸°íš ì¤€ìˆ˜: ë³‘ë ¬ íƒìƒ‰ ê°€ëŠ¥                       â”‚
     â”‚ 2. ì‚¬ìš©ì ê²½í—˜ ê°œì„ : ììœ ë¡œìš´ ì¡°ì‚¬ íë¦„                 â”‚
     â”‚ 3. íƒì • ê²Œì„ ë³¸ì§ˆ: ì¦ê±°â†”ì‹¬ë¬¸ ë°˜ë³µ                       â”‚
     â”‚ 4. ì½”ë“œ êµ¬ì¡° ê°œì„ : Investigation ë¡œì§ í†µí•©              â”‚
     â”‚                                                         â”‚
     â”‚ ---                                                     â”‚
     â”‚ ì´ ê³„íšëŒ€ë¡œ ìˆ˜ì •í•˜ì‹œê² ìŠµë‹ˆê¹Œ?    