> **ì„¤ê³„ ì² í•™:** Spirit of Kiroì˜ ê²€ì¦ëœ íŒ¨í„´ + Presentation/Business Logic ë¶„ë¦¬ + ìµœì†Œ ë³µì¡ë„ + ë¹„ìš© íš¨ìœ¨ì  AI ë„¤ì´í‹°ë¸Œ ì•„í‚¤í…ì²˜
> 

<aside>
ğŸ¯

**v2.0 ì£¼ìš” ê°œì„ ì‚¬í•­**

ë³¸ ë¬¸ì„œëŠ” Spirit of Kiro ë¶„ì„ì„ í†µí•´ ë„ì¶œí•œ í•µì‹¬ íŒ¨í„´ë“¤ì„ ì „ëµ Aì— êµ¬ì²´ì ìœ¼ë¡œ í†µí•©í•©ë‹ˆë‹¤:

- âœ… **CaseElementLibrary**: Kiroì˜ word-lists íŒ¨í„´ìœ¼ë¡œ ì¼ê´€ì„± ìˆëŠ” ì‚¬ê±´ ìƒì„±
- âœ… **ê°ì • ìƒíƒœ ì‹œìŠ¤í…œ**: ìš©ì˜ì AIì˜ ë™ì  í˜ë¥´ì†Œë‚˜ ë³€í™”
- âœ… **ë²¡í„° ìºì‹±**: ì´ë¯¸ì§€ ìƒì„± ë¹„ìš© 90% ì ˆê° ì „ëµ
- âœ… **ì™¸ë¶€ ì„œë¹„ìŠ¤ ë¶„ë¦¬**: Devvit 1ì´ˆ ì œí•œ ìš°íšŒ ì•„í‚¤í…ì²˜
- âœ… **íŠ¸ëœì­ì…˜ íŒ¨í„´**: ë°ì´í„° ì •í•©ì„± ë³´ì¥
</aside>

---

## 0. Spirit of Kiro íŒ¨í„´ ë§¤í•‘ ìš”ì•½

ì „ëµ Aì™€ Spirit of Kiroì˜ í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜ ë¹„êµ:

| **êµ¬ë¶„** | **Spirit of Kiro** | **ë ˆë”§ íƒì • ì‚¬ë¬´ì†Œ (ì „ëµ A)** | **ì ìš© ëª¨ë“ˆ** |
| --- | --- | --- | --- |
| **PCG ì…ë ¥** | ëœë¤ ì‹œë“œ + word-lists | ë‚ ì§œ ì‹œë“œ + CaseElementLibrary | CaseGeneratorService |
| **ìƒí˜¸ì‘ìš©** | useSkill (ì•„ì´í…œ â†” ì•„ì´í…œ) | AI ì‹¬ë¬¸ (íƒì • â†” ìš©ì˜ì) | SuspectAIService |
| **ë™ì  ì†ì„±** | ì•„ì´í…œ quirks ë³€í™” | ìš©ì˜ì ê°ì • ìƒíƒœ ë³€í™” | SuspectContext.state |
| **ë¹„ìš© ìµœì í™”** | ì´ë¯¸ì§€ ë²¡í„° ìºì‹± | í”„ë¡¬í”„íŠ¸ ì„ë² ë”© â†’ ìœ ì‚¬ë„ ê²€ìƒ‰ | ImageGeneratorService |
| **ìƒíƒœ ê´€ë¦¬** | DynamoDB íŠ¸ëœì­ì…˜ | Redis ì›ìì  ì—°ì‚° | KVStoreManager |
| **ì¶œë ¥ í˜•ì‹** | YAML (êµ¬ì¡°í™”) | YAML (ì‚¬ê±´/ìš©ì˜ì ë°ì´í„°) | í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ |

---

## 1. ê°œìš”

### 1.1 í•µì‹¬ ëª¨ë“ˆ ëª©ë¡ (Spirit of Kiro íŒ¨í„´ í†µí•©)

**Presentation Layer (Devvit Web View - React + TypeScript)**

| ëª¨ë“ˆëª… | ìœ„ì¹˜ | ì„¤ëª… | **Kiro íŒ¨í„´** |
| --- | --- | --- | --- |
| **CaseOverview** | `/webroot/components/CaseOverview.tsx` | ì‚¬ê±´ ê°œìš”, í˜„ì¥ ì´ë¯¸ì§€, í”¼í•´ì ì •ë³´ í‘œì‹œ | Kiroì˜ ì•„ì´í…œ ìƒì„¸ UI íŒ¨í„´ |
| **SuspectPanel** | `/webroot/components/SuspectPanel.tsx` | 3ëª…ì˜ ìš©ì˜ì í”„ë¡œí•„ ì¹´ë“œ | ì¸ë²¤í† ë¦¬ ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ |
| **ChatInterface** | `/webroot/components/ChatInterface.tsx` | Vercel AI SDK ê¸°ë°˜ ì‹¤ì‹œê°„ ëŒ€í™” UI | **useSkillStream ìŠ¤íŠ¸ë¦¬ë°** |
| **SubmissionForm** | `/webroot/components/SubmissionForm.tsx` | 1W4H ì¶”ë¦¬ ì œì¶œ í¼ | - |
| **LeaderboardView** | `/webroot/components/LeaderboardView.tsx` | ìƒìœ„ 10ëª… ë¦¬ë”ë³´ë“œ + ë‚´ ìˆœìœ„ | Kiro ë¦¬ë”ë³´ë“œ UI |
| **GameTimeline** | `/webroot/components/GameTimeline.tsx` | ì¼ì¼ ê²Œì„ ì§„í–‰ íƒ€ì„ë¼ì¸ | - |

**Business Logic (Devvit Server - Node.js) - Kiro íŒ¨í„´ ê°•í™”**

| ëª¨ë“ˆëª… | ìœ„ì¹˜ | ì„¤ëª… | **Kiro íŒ¨í„´ ì ìš©** |
| --- | --- | --- | --- |
| **CaseElementLibrary** â­ | `/src/services/caseModules/CaseElementLibrary.ts` | **ë‚ ì§œ ì‹œë“œ ê¸°ë°˜ ì‚¬ê±´ ìš”ì†Œ ì„ íƒ** | **âœ… word-lists + randomInspiration** |
| **CaseGeneratorService** | `/src/services/CaseGeneratorService.ts` | LLM ê¸°ë°˜ ì‚¬ê±´ ìƒì„± + YAML íŒŒì‹± | **âœ… êµ¬ì¡°í™”ëœ í”„ë¡¬í”„íŠ¸ + ê²€ì¦ ì¬ì‹œë„** |
| **SuspectAIService** â­ | `/src/services/SuspectAIService.ts` | **ê°ì • ìƒíƒœ ê¸°ë°˜ ë™ì  ìš©ì˜ì AI** | **âœ… quirks â†’ SuspectContext ë§¤í•‘** |
| **ScoringEngine** | `/src/services/ScoringEngine.ts` | 1W4H ì±„ì  ë¡œì§ (ë¶€ë¶„ ì ìˆ˜) | - |
| **SchedulerTrigger** | `/src/triggers/DailyCaseScheduler.ts` | ì¼ì¼ ì‚¬ê±´ ìë™ ê²Œì‹œ (KST 09:00) | - |
| **KVStoreManager** â­ | `/src/data/KVStoreManager.ts` | **ì›ìì  íŠ¸ëœì­ì…˜ ê¸°ë°˜ ìƒíƒœ ê´€ë¦¬** | **âœ… moveItemLocation íŒ¨í„´** |
| **ImageGeneratorService** â­ | `/src/services/ImageGeneratorService.ts` | **ì™¸ë¶€ Vercel Function í˜¸ì¶œ** | **âœ… ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ë¶„ë¦¬** |

**External Services (Kiro íŒ¨í„´ í•µì‹¬ ë„ì…)**

| ì„œë¹„ìŠ¤ | ìš©ë„ | **Kiro íŒ¨í„´** |
| --- | --- | --- |
| **Vercel Function** â­ | ì´ë¯¸ì§€ ìƒì„± + **ë²¡í„° ìºì‹±** | **âœ… item-images ì„œë¹„ìŠ¤ ëª¨ë¸** |
| **Upstash Redis / MemoryDB** | **í”„ë¡¬í”„íŠ¸ ì„ë² ë”© ë²¡í„° ì €ì¥** | **âœ… ì½”ì‚¬ì¸ ìœ ì‚¬ë„ ê²€ìƒ‰** |
| Google Gemini Flash Lite | LLM ì¶”ë¡  (ì‚¬ê±´ ìƒì„± + ëŒ€í™”) | - |
| Imagen/DALL-E | ì‚¬ê±´ í˜„ì¥ ì´ë¯¸ì§€ ìƒì„± | - |
| Devvit KV Store | ê²Œì„ ìƒíƒœ ì €ì¥ | - |

---

## 2. Architecture Diagram (Spirit of Kiro íŒ¨í„´ í†µí•©)

### 2.1 ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```mermaid
graph TB
    subgraph "Devvit App (Reddit Platform)"
        A[Scheduler<br/>09:00 KST]
        B[CaseGeneratorService<br/>+ CaseElementLibrary<br/>Kiro word-lists íŒ¨í„´]
        C[CommentSubmit Trigger]
        D[SuspectAIService<br/>+ Emotional State<br/>Kiro quirks íŒ¨í„´]
        E[KV Store<br/>Redis<br/>ì›ìì  íŠ¸ëœì­ì…˜]
    end

    subgraph "External Services (Kiro íŒ¨í„´)"
        F[Vercel Function<br/>Image Generator<br/>item-images ëª¨ë¸]
        G[Vector Store<br/>MemoryDB/Upstash<br/>ì½”ì‚¬ì¸ ìœ ì‚¬ë„ ìºì‹±]
        H[Imagen API]
        I[Gemini API]
    end

    A -->|ë‚ ì§œ ì‹œë“œ| B
    B -->|CaseElementLibrary<br/>ìš”ì†Œ ì¡°í•©| I
    I -->|YAML ì‚¬ê±´| B
    B -->|ì´ë¯¸ì§€ í”„ë¡¬í”„íŠ¸| F
    
    F -->|ë²¡í„° ê²€ìƒ‰<br/>threshold=0.95| G
    G -.ìºì‹œ ë¯¸ìŠ¤.-> H
    H -->|ìƒˆ ì´ë¯¸ì§€| G
    F -->|ì´ë¯¸ì§€ URL| B
    
    B -->|ì‚¬ê±´ ì €ì¥| E
    B -->|ê²Œì‹œë¬¼ ì‘ì„±| A
    
    C -->|ì§ˆë¬¸ ê°ì§€| D
    D -->|SuspectContext<br/>ì¡°íšŒ| E
    D -->|ë™ì  í”„ë¡¬í”„íŠ¸<br/>ê°ì • ìƒíƒœ ë°˜ì˜| I
    I -->|ìŠ¤íŠ¸ë¦¬ë° ë‹µë³€<br/>useSkillStream íŒ¨í„´| D
    D -->|suspicionLevel<br/>ì—…ë°ì´íŠ¸| E

    style B fill:#e3f2fd
    style D fill:#e3f2fd
    style F fill:#fff3e0
    style G fill:#f3e5f5
```

### 2.2 Kiro íŒ¨í„´ vs Devvit ë§¤í•‘

| **Spirit of Kiro íŒ¨í„´** | **ë ˆë”§ íƒì • ì‚¬ë¬´ì†Œ êµ¬í˜„** |
| --- | --- |
| `message: 'pull-item'` | `Devvit.addScheduler` (ì¼ì¼ ì‚¬ê±´ ìƒì„±) |
| `message: 'use-skill'` | `Devvit.addTrigger({ event: 'CommentSubmit' })` |
| WebSocket ì„œë²„ í‘¸ì‹œ | `context.reddit.submitPost`, ë´‡ ë‹µê¸€ |
| `handlePullItem.ts` | `DailyCaseScheduler.ts` |
| `item-store.ts` (DynamoDB) | `KVStoreManager.ts` (Redis) |
| `item-images` ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ | Vercel Function `/api/generate-scene-image` |

---

## 3. í•µì‹¬ ëª¨ë“ˆ ìƒì„¸ ì„¤ê³„ (Spirit of Kiro íŒ¨í„´ ì ìš©)

### 3.1 CaseElementLibrary â­ (ì‹ ê·œ - Kiroì˜ word-lists íŒ¨í„´)

**íŒŒì¼ ìœ„ì¹˜:** `/src/services/caseModules/CaseElementLibrary.ts`

**ëª©ì :** Spirit of Kiroì˜ `randomInspiration()` íŒ¨í„´ì„ ì°¨ìš©í•˜ì—¬, ë‚ ì§œ ì‹œë“œ ê¸°ë°˜ìœ¼ë¡œ ì¼ê´€ì„± ìˆëŠ” ì‚¬ê±´ ìš”ì†Œë¥¼ ì„ íƒí•©ë‹ˆë‹¤.

**êµ¬í˜„:**

```tsx
// /src/services/caseModules/CaseElementLibrary.ts

export const CaseElementLibrary = {
  // Kiroì˜ word-lists êµ¬ì¡° ì°¨ìš©
  weapons: [
    'ë…ê·¹ë¬¼', 'ë‘”ê¸°', 'ë‚ ì¹´ë¡œìš´ í‰ê¸°', 'êµì‚´', 'ì¶”ë½', 
    'ì „ê¸° ê°ì „', 'ì§ˆì‹', 'ìµì‚¬', 'í™”ì¬', 'ì €ì²´ì˜¨ì¦'
  ],
  
  motives: [
    { category: 'ê¸ˆì „', keywords: ['ìœ ì‚°', 'ë³´í—˜ê¸ˆ', 'ë¹š', 'íš¡ë ¹'] },
    { category: 'ë³µìˆ˜', keywords: ['ë°°ì‹ ', 'ì›í•œ', 'ëª¨ìš•', 'ê²½ìŸ'] },
    { category: 'ì€í', keywords: ['ë¹„ë°€', 'ìŠ¤ìº”ë“¤', 'ë²”ì£„', 'ê³¼ê±°'] },
    { category: 'ì§ˆíˆ¬', keywords: ['ì—°ì¸', 'ìŠ¹ì§„', 'ì¬ëŠ¥', 'ëª…ì„±'] },
    { category: 'ê´‘ê¸°', keywords: ['ì§‘ì°©', 'í¸ì§‘ì¦', 'í™˜ê°', 'ì¶©ë™'] }
  ],
  
  locations: [
    { name: 'ë°€ì‹¤ ì„œì¬', props: ['ì±…ì¥', 'ê¸ˆê³ ', 'ì•¤í‹°í¬ ì‹œê³„', 'ë¹„ë°€ í†µë¡œ'] },
    { name: 'íœíŠ¸í•˜ìš°ìŠ¤', props: ['ë°œì½”ë‹ˆ', 'ì™€ì¸ ì €ì¥ê³ ', 'í™ˆì‹œì–´í„°', 'CCTV'] },
    { name: 'ì§€í•˜ ì£¼ì°¨ì¥', props: ['ìë™ì°¨', 'ê³µêµ¬', 'ë³´ì•ˆ ì¹´ë©”ë¼', 'ë¹„ìƒêµ¬'] },
    { name: 'ê³ ê¸‰ ë ˆìŠ¤í† ë‘', props: ['ì£¼ë°©', 'ì™€ì¸ ì…€ëŸ¬', 'ëƒ‰ì¥ê³ ', 'ì˜ˆì•½ ê¸°ë¡'] },
    { name: 'ìš”íŠ¸', props: ['ì¡°íƒ€ì‹¤', 'ì„ ì‹¤', 'êµ¬ëª…ì¡°ë¼', 'í•­í•´ ì¼ì§€'] }
  ],
  
  victims: [
    { occupation: 'CEO', age: '40-50ëŒ€', background: 'ë²¤ì²˜ ìºí”¼í„¸', personality: 'ê¶Œìœ„ì ' },
    { occupation: 'ë°°ìš°', age: '30ëŒ€', background: 'ì¸ê¸° ìƒìŠ¹ ì¤‘', personality: 'ìê¸°ì• ì ' },
    { occupation: 'ë³€í˜¸ì‚¬', age: '40ëŒ€', background: 'ëŒ€í˜• ë¡œíŒ', personality: 'ëƒ‰ì •í•œ' },
    { occupation: 'ì˜ˆìˆ ê°€', age: '50ëŒ€', background: 'ìœ ëª… í™”ê°€', personality: 'ê´´íŒí•œ' },
    { occupation: 'ì˜ì‚¬', age: '30ëŒ€', background: 'ì„±í˜•ì™¸ê³¼', personality: 'ì™„ë²½ì£¼ì˜' }
  ],
  
  redHerrings: [
    'í˜„ì¥ì— ë‚¨ê²¨ì§„ ëˆ„êµ°ê°€ì˜ ì§€ë¬¸',
    'ì‚¬ë¼ì§„ ì¤‘ìš” ë¬¸ì„œ',
    'CCTV ì‚¬ê°ì§€ëŒ€',
    'ëª¨ìˆœëœ ì‹œê°„ëŒ€ì˜ ëª©ê²© ì¦ì–¸',
    'ì˜ì‹¬ìŠ¤ëŸ¬ìš´ í†µí™” ê¸°ë¡',
    'í”¼í•´ìì˜ ìˆ˜ìƒí•œ ê±°ë˜ ë‚´ì—­'
  ],
  
  suspectTraits: {
    personalities: [
      'ë‹¤í˜ˆì§ˆ', 'ëƒ‰ì •í•¨', 'ë¶ˆì•ˆí•´í•˜ëŠ”', 'êµí™œí•œ', 'ì–´ë¦¬ìˆ™í•œ',
      'ì˜¤ë§Œí•œ', 'ìš°ìœ ë¶€ë‹¨í•œ', 'ì‹ ê²½ì§ˆì ', 'ì¹¨ì°©í•œ', 'ë°©ì–´ì '
    ],
    speechPatterns: [
      'ë§ì„ ë”ë“¬ìŒ', 'ì „ë¬¸ ìš©ì–´ ì‚¬ìš©', 'ë¹„ê¼¬ëŠ” ì–´ì¡°', 'ê³¼ë„í•˜ê²Œ ì •ì¤‘í•¨',
      'ë§ì´ ë§ìŒ', 'ë§ì´ ì ìŒ', 'ìì£¼ ë³€ëª…í•¨', 'ê³µê²©ì '
    ],
    relations: [
      'ì‚¬ì—… íŒŒíŠ¸ë„ˆ', 'ì „ ë°°ìš°ì', 'ì±„ê¶Œì', 'ê²½ìŸì',
      'ë¹„ì„œ', 'ê°€ì¡±', 'ì œì', 'ì¹œêµ¬', 'ë™ë£Œ'
    ]
  }
};

// ë‚ ì§œ ì‹œë“œ ê¸°ë°˜ ìš”ì†Œ ì„ íƒ (Kiroì˜ deterministic randomness)
export function getDailyElements(dateSeed: string): DailyCaseElements {
  const seed = hashDateToNumber(dateSeed);
  
  return {
    weapon: selectFromSeed(CaseElementLibrary.weapons, seed, 0),
    motive: selectFromSeed(CaseElementLibrary.motives, seed, 1),
    location: selectFromSeed(CaseElementLibrary.locations, seed, 2),
    victim: selectFromSeed(CaseElementLibrary.victims, seed, 3),
    redHerring: selectFromSeed(CaseElementLibrary.redHerrings, seed, 4),
    suspectTraits: {
      personalities: selectMultipleFromSeed(
        CaseElementLibrary.suspectTraits.personalities, 
        seed, 
        5, 
        3
      ),
      speechPatterns: selectMultipleFromSeed(
        CaseElementLibrary.suspectTraits.speechPatterns,
        seed,
        6,
        3
      ),
      relations: selectMultipleFromSeed(
        CaseElementLibrary.suspectTraits.relations,
        seed,
        7,
        3
      )
    }
  };
}

// í•´ì‹œ í•¨ìˆ˜ (ë‚ ì§œ â†’ ìˆ«ì ì‹œë“œ)
function hashDateToNumber(date: string): number {
  let hash = 0;
  for (let i = 0; i < date.length; i++) {
    hash = ((hash << 5) - hash) + date.charCodeAt(i);
    hash |= 0;
  }
  return Math.abs(hash);
}

// ì‹œë“œ ê¸°ë°˜ ì„ íƒ (Kiro íŒ¨í„´)
function selectFromSeed<T>(array: T[], seed: number, offset: number): T {
  const index = (seed + offset) % array.length;
  return array[index];
}

function selectMultipleFromSeed<T>(
  array: T[], 
  seed: number, 
  offset: number, 
  count: number
): T[] {
  const results: T[] = [];
  for (let i = 0; i < count; i++) {
    results.push(selectFromSeed(array, seed, offset + i));
  }
  return results;
}

interface DailyCaseElements {
  weapon: string;
  motive: { category: string; keywords: string[] };
  location: { name: string; props: string[] };
  victim: { occupation: string; age: string; background: string; personality: string };
  redHerring: string;
  suspectTraits: {
    personalities: string[];
    speechPatterns: string[];
    relations: string[];
  };
}
```

**í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤:**

```tsx
describe('CaseElementLibrary', () => {
  test('ë™ì¼í•œ ë‚ ì§œ ì‹œë“œëŠ” ë™ì¼í•œ ìš”ì†Œ ë°˜í™˜', () => {
    const elements1 = getDailyElements('2025-10-15');
    const elements2 = getDailyElements('2025-10-15');
    expect(elements1).toEqual(elements2);
  });

  test('ë‹¤ë¥¸ ë‚ ì§œëŠ” ë‹¤ë¥¸ ìš”ì†Œ ë°˜í™˜', () => {
    const elements1 = getDailyElements('2025-10-15');
    const elements2 = getDailyElements('2025-10-16');
    expect(elements1).not.toEqual(elements2);
  });

  test('ëª¨ë“  í•„ìˆ˜ ìš”ì†Œ í¬í•¨', () => {
    const elements = getDailyElements('2025-10-15');
    expect(elements.weapon).toBeDefined();
    expect(elements.motive).toBeDefined();
    expect(elements.location).toBeDefined();
    expect(elements.victim).toBeDefined();
    expect(elements.redHerring).toBeDefined();
    expect(elements.suspectTraits.personalities).toHaveLength(3);
  });
});
```

---

### 3.2 CaseGeneratorService (Kiro YAML í”„ë¡¬í”„íŠ¸ íŒ¨í„´)

**ê°œì„  ì‚¬í•­:**

1. **CaseElementLibrary í†µí•©**
2. **YAML ì¶œë ¥ í˜•ì‹ ê°•ì œ**
3. **Kiroì˜ ê²€ì¦ ì¬ì‹œë„ ë¡œì§**

**êµ¬í˜„:**

```tsx
// /src/services/CaseGeneratorService.ts

import { getDailyElements } from './caseModules/CaseElementLibrary';
import * as yaml from 'js-yaml';

class CaseGeneratorService {
  async generateCase(date: string): Promise<Case> {
    // 1. Kiro íŒ¨í„´: ë‚ ì§œ ì‹œë“œë¡œ ìš”ì†Œ ì„ íƒ
    const elements = getDailyElements(date);
    
    // 2. Kiro íŒ¨í„´: êµ¬ì¡°í™”ëœ í”„ë¡¬í”„íŠ¸ (YAML ì¶œë ¥ ê°•ì œ)
    const systemPrompt = `ë‹¹ì‹ ì€ ì¶”ë¦¬ ì†Œì„¤ ì‘ê°€ì…ë‹ˆë‹¤. 
ì£¼ì–´ì§„ ìš”ì†Œë¥¼ ì¡°í•©í•˜ì—¬ ë…¼ë¦¬ì ìœ¼ë¡œ í•´ê²° ê°€ëŠ¥í•œ ì‚´ì¸ ì‚¬ê±´ì„ YAML í˜•ì‹ìœ¼ë¡œ ìƒì„±í•˜ì„¸ìš”.

**í•„ìˆ˜ ê·œì¹™:**
1. ë²”ì¸ì€ ì •í™•íˆ 1ëª…
2. ëª¨ë“  ë‹¨ì„œëŠ” ë²”ì¸ì„ ë…¼ë¦¬ì ìœ¼ë¡œ ê°€ë¦¬ì¼œì•¼ í•¨
3. Red herringì€ 1-2ê°œë§Œ í¬í•¨
4. ì•Œë¦¬ë°”ì´ëŠ” êµ¬ì²´ì ì¸ ì‹œê°„ê³¼ ì¥ì†Œ í¬í•¨

**ì¶œë ¥ í˜•ì‹ (YAML):**
\`\`\`yaml
title: "15ì ì´ë‚´ì˜ ë§¤ë ¥ì ì¸ ì‚¬ê±´ëª…"
victim:
  name: "ì´ë¦„"
  occupation: "${elements.victim.occupation}"
  age: ${elements.victim.age}
  background: "${elements.victim.background}"
  personality: "${elements.victim.personality}"
  foundAt: "YYYY-MM-DDTHH:mm:ss+09:00"
  foundLocation: "${[elements.location.name](http://elements.location.name)}"

suspects:
  - id: "suspect_A"
    name: "ì´ë¦„"
    age: ìˆ«ì
    occupation: "ì§ì—…"
    relationToVictim: "${elements.suspectTraits.relations[0]}"
    personality: "${elements.suspectTraits.personalities[0]}"
    speechPattern: "${elements.suspectTraits.speechPatterns[0]}"
    alibi: "êµ¬ì²´ì  ì•Œë¦¬ë°”ì´ (ì‹œê°„, ì¥ì†Œ, ëª©ê²©ì)"
    avatar: "ğŸ§‘"
  - id: "suspect_B"
    name: "ì´ë¦„"
    age: ìˆ«ì
    occupation: "ì§ì—…"
    relationToVictim: "${elements.suspectTraits.relations[1]}"
    personality: "${elements.suspectTraits.personalities[1]}"
    speechPattern: "${elements.suspectTraits.speechPatterns[1]}"
    alibi: "êµ¬ì²´ì  ì•Œë¦¬ë°”ì´"
    avatar: "ğŸ‘¨"
  - id: "suspect_C"
    name: "ì´ë¦„"
    age: ìˆ«ì
    occupation: "ì§ì—…"
    relationToVictim: "${elements.suspectTraits.relations[2]}"
    personality: "${elements.suspectTraits.personalities[2]}"
    speechPattern: "${elements.suspectTraits.speechPatterns[2]}"
    alibi: "êµ¬ì²´ì  ì•Œë¦¬ë°”ì´"
    avatar: "ğŸ‘©"

evidence:
  - id: "evidence_1"
    type: "physical"
    description: "ì¦ê±° ì„¤ëª… (50ì)"
    importance: "high"
    discoveredAt: null
  - id: "evidence_2"
    type: "testimony"
    description: "ì¦ê±° ì„¤ëª…"
    importance: "medium"
  # ... ì´ 5ê°œ

timeline:
  - time: "ì–´ì œ 20:00"
    event: "í”¼í•´ì ë§ˆì§€ë§‰ ëª©ê²©"
    participants: ["victim", "suspect_A"]
  - time: "ì–´ì œ 22:00"
    event: "ë²”í–‰ ì¶”ì • ì‹œê°"
    participants: ["victim", "culprit"]
  # ... 5-7ê°œ

solution:
  culprit: "suspect_A"
  method: "${elements.weapon}"
  motive:
    category: "${elements.motive.category}"
    description: "${elements.motive.keywords} ê´€ë ¨ êµ¬ì²´ì  ë™ê¸° (100ì)"
  when: "ì–´ì œ 22:00-23:00"
  where: "${[elements.location.name](http://elements.location.name)}ì˜ íŠ¹ì • ì¥ì†Œ"
  explanation: "í•´ê²° í•´ì„¤ (200ì)"
\`\`\`
`;

    const userPrompt = `
ë‚ ì§œ ì‹œë“œ: ${date}
ì‚¬ê±´ ë°°ê²½ í‚¤ì›Œë“œ: ${elements.motive.keywords.join(', ')}
ì¥ì†Œ ì†Œí’ˆ: ${elements.location.props.join(', ')}
Red Herring: ${elements.redHerring}

ìœ„ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì‚¬ê±´ì„ ìƒì„±í•˜ì„¸ìš”.
`;

    try {
      // 3. LLM í˜¸ì¶œ
      const result = await this.callGeminiAPI(systemPrompt, userPrompt);
      
      // 4. YAML íŒŒì‹± (Kiro íŒ¨í„´)
      const caseData = yaml.load(result) as Case;
      
      // 5. Kiro íŒ¨í„´: ê²€ì¦ í›„ ì¬ì‹œë„
      if (!this.validateCase(caseData)) {
        console.warn('ìƒì„±ëœ ì‚¬ê±´ì´ ê²€ì¦ ì‹¤íŒ¨, ì¬ìƒì„± ì‹œë„');
        return this.generateCase(date); // ì¬ê·€ ì¬ì‹œë„
      }
      
      // 6. ë©”íƒ€ë°ì´í„° ì¶”ê°€
      [caseData.id](http://caseData.id) = `case_${date.replace(/-/g, '')}`;
      [caseData.date](http://caseData.date) = date;
      caseData.sceneImageUrl = ''; // ì´ë¯¸ì§€ ìƒì„± ì„œë¹„ìŠ¤ì—ì„œ ì¶”ê°€
      
      return caseData;
      
    } catch (error) {
      console.error('ì‚¬ê±´ ìƒì„± ì‹¤íŒ¨:', error);
      // Kiroì˜ í´ë°± ì „ëµ: ì¬ì‹œë„ ë˜ëŠ” ê¸°ë³¸ ì‚¬ê±´ ë°˜í™˜
      throw error;
    }
  }

  // Kiro íŒ¨í„´: êµ¬ì¡° ê²€ì¦
  private validateCase(caseData: any): boolean {
    return !!(
      caseData.title &&
      caseData.victim &&
      caseData.suspects?.length === 3 &&
      caseData.evidence?.length >= 5 &&
      caseData.timeline?.length >= 5 &&
      caseData.solution?.culprit &&
      ['suspect_A', 'suspect_B', 'suspect_C'].includes(caseData.solution.culprit)
    );
  }

  private async callGeminiAPI(systemPrompt: string, userPrompt: string): Promise<string> {
    // Gemini API í˜¸ì¶œ ë¡œì§
    // ...
  }
}
```

---

### 3.3 SuspectAIService â­ (Kiro useSkill íŒ¨í„´ + ê°ì • ìƒíƒœ)

**í•µì‹¬ ê°œì„ :**

1. **SuspectContext êµ¬ì¡°** (Kiro ì•„ì´í…œ ì†ì„± êµ¬ì¡° ì°¨ìš©)
2. **ê°ì • ìƒíƒœ ì‹œìŠ¤í…œ** (suspicionLevel 0-100)
3. **ë™ì  í”„ë¡¬í”„íŠ¸ ìƒì„±** (ê°ì •ì— ë”°ë¥¸ ì–´ì¡° ë³€í™”)
4. **ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ** (Kiro useSkillStream íŒ¨í„´)

**êµ¬í˜„:**

```tsx
// /src/services/SuspectAIService.ts

interface SuspectContext {
  // Layer 1: ë¶ˆë³€ ì •ë³´ (Kiro core attributes)
  core: {
    suspectId: string;
    name: string;
    personality: string; // "ë‹¤í˜ˆì§ˆ", "ëƒ‰ì •í•¨", "ë¶ˆì•ˆí•´í•˜ëŠ”"
    speechPattern: string; // "ë§ì„ ë”ë“¬ìŒ", "ì „ë¬¸ìš©ì–´ ì‚¬ìš©"
    relationToVictim: string;
  };
  
  // Layer 2: ë¹„ë°€ ì •ë³´ (Kiro quirks)
  secrets: {
    alibi: string;
    truth: string; // ì‹¤ì œ í–‰ë™ (ë²”ì¸ì´ë©´ ë²”í–‰, ì•„ë‹ˆë©´ ì§„ì§œ ì•Œë¦¬ë°”ì´)
    guilt: boolean;
    motive?: string; // ë²”ì¸ì¸ ê²½ìš°ë§Œ
  };
  
  // Layer 3: ë™ì  ìƒíƒœ (Kiro ë™ì  ì†ì„±)
  state: {
    suspicionLevel: number; // 0-100, ì§ˆë¬¸ì— ë”°ë¼ ë™ì  ë³€í™”
    revealedFacts: string[]; // ì´ë¯¸ ë°íŒ ì‚¬ì‹¤ë“¤
    caughtInLies: number; // ê±°ì§“ë§ ë°œê° íšŸìˆ˜
    conversationCount: number; // ì´ ëŒ€í™” ìˆ˜
  };
}

class SuspectAIService {
  async chat(
    suspectId: string,
    question: string,
    conversationHistory: Message[]
  ): Promise<ReadableStream> {
    // 1. ì»¨í…ìŠ¤íŠ¸ ì¡°íšŒ
    const suspect = await this.getSuspectContext(suspectId);
    
    // 2. Kiro íŒ¨í„´: ë™ì  ê°ì • ìƒíƒœ ê³„ì‚°
    const emotionalTone = this.getEmotionalTone(suspect.state.suspicionLevel);
    
    // 3. ì§ˆë¬¸ ë‚ ì¹´ë¡œì›€ ë¶„ì„ (suspicionLevel ì—…ë°ì´íŠ¸ìš©)
    const questionSharpness = this.analyzeQuestionSharpness(question, suspect);
    
    // 4. Kiro íŒ¨í„´: ìƒíƒœ ê¸°ë°˜ ë™ì  í”„ë¡¬í”„íŠ¸
    const systemPrompt = `
ë‹¹ì‹ ì€ ${[suspect.core.name](http://suspect.core.name)}ì…ë‹ˆë‹¤.

## ë‹¹ì‹ ì˜ í”„ë¡œí•„
- ì„±ê²©: ${suspect.core.personality}
- ë§íˆ¬: ${suspect.core.speechPattern}
- í”¼í•´ìì™€ì˜ ê´€ê³„: ${suspect.core.relationToVictim}

## í˜„ì¬ ì‹¬ë¦¬ ìƒíƒœ (ì¤‘ìš”!)
${emotionalTone}

## ë‹¹ì‹ ì´ ì•Œê³  ìˆëŠ” ì‚¬ì‹¤
- ê³µì‹ ì•Œë¦¬ë°”ì´: ${suspect.secrets.alibi}
- ì‹¤ì œ í–‰ë™: ${suspect.secrets.truth}
${suspect.secrets.guilt ? `- âš ï¸ ë‹¹ì‹ ì€ ë²”ì¸ì…ë‹ˆë‹¤. ì ˆëŒ€ ì¸ì •í•˜ì§€ ë§ˆì„¸ìš”.` : ''}

${suspect.state.caughtInLies > 0 ? `
## âš ï¸ ìœ„ê¸° ìƒí™©
ë‹¹ì‹ ì€ ì´ë¯¸ ${suspect.state.caughtInLies}ë²ˆ ê±°ì§“ë§ì´ ë°œê°ë˜ì—ˆìŠµë‹ˆë‹¤!
ë§¤ìš° ë°©ì–´ì ìœ¼ë¡œ ë°˜ì‘í•˜ê³ , ì§ˆë¬¸ì„ íšŒí”¼í•˜ê±°ë‚˜ ê³µê²©ì ìœ¼ë¡œ ëŒ€ì‘í•˜ì„¸ìš”.
` : ''}

## ëŒ€í™” ê·œì¹™
1. ${suspect.core.speechPattern} ë§íˆ¬ë¥¼ **ë°˜ë“œì‹œ** ìœ ì§€í•˜ì„¸ìš”
2. ì•Œë¦¬ë°”ì´ë¥¼ ê³ ìˆ˜í•˜ë˜, ì§ˆë¬¸ì´ ë‚ ì¹´ë¡œìš°ë©´ ${suspect.core.personality} ì„±ê²©ë‹µê²Œ ë™ìš”í•˜ì„¸ìš”
3. ì§„ì‹¤(${suspect.secrets.truth})ì„ ì§ì ‘ ë§í•˜ì§€ ë§ê³  **ì•”ì‹œë§Œ** í•˜ì„¸ìš”
4. ë‹µë³€ì€ 3-5ë¬¸ì¥ìœ¼ë¡œ ê°„ê²°í•˜ê²Œ
5. ${suspect.core.personality} ì„±ê²©ì´ ë“œëŸ¬ë‚˜ë„ë¡ ë‹µë³€í•˜ì„¸ìš”

## ì´ë¯¸ ë°íŒ ì‚¬ì‹¤ë“¤ (ì¼ê´€ì„± ìœ ì§€ í•„ìˆ˜!)
${[suspect.state.revealedFacts.map](http://suspect.state.revealedFacts.map)(f => `- ${f}`).join('\n')}
`;

    // 5. Kiroì˜ useSkillStream íŒ¨í„´ ì°¨ìš©
    const stream = await streamText({
      model: gemini('gemini-1.5-flash'),
      system: systemPrompt,
      messages: conversationHistory,
      temperature: this.getTemperature(suspect.state.suspicionLevel),
      onFinish: async (result) => {
        // 6. ë‹µë³€ ë¶„ì„ ë° ìƒíƒœ ì—…ë°ì´íŠ¸
        await this.updateSuspectState(
          suspectId, 
          result.text, 
          questionSharpness
        );
      }
    });
    
    return stream.toReadableStream();
  }

  // Kiro íŒ¨í„´: ë™ì  ê°ì • ìƒíƒœ
  private getEmotionalTone(suspicionLevel: number): string {
    if (suspicionLevel > 80) {
      return "ğŸ”´ ê·¹ë„ë¡œ ê¸´ì¥í•˜ì—¬ ë§ì„ ë”ë“¬ê³  ë•€ì„ í˜ë¦½ë‹ˆë‹¤. ê³µê²©ì ìœ¼ë¡œ ë°˜ì‘í•˜ê±°ë‚˜ ëŒ€í™”ë¥¼ ëŠìœ¼ë ¤ í•©ë‹ˆë‹¤.";
    } else if (suspicionLevel > 60) {
      return "ğŸŸ  ìƒë‹¹íˆ ë¶ˆì•ˆí•´í•˜ë©° ë°©ì–´ì ì…ë‹ˆë‹¤. ì§ˆë¬¸ì„ íšŒí”¼í•˜ê±°ë‚˜ ì£¼ì œë¥¼ ëŒë¦¬ë ¤ í•©ë‹ˆë‹¤.";
    } else if (suspicionLevel > 40) {
      return "ğŸŸ¡ ì•½ê°„ ê¸´ì¥í•˜ê³  ìˆì§€ë§Œ ì¹¨ì°©í•¨ì„ ìœ ì§€í•˜ë ¤ í•©ë‹ˆë‹¤. ê°€ë” ë§ì‹¤ìˆ˜ë¥¼ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.";
    } else if (suspicionLevel > 20) {
      return "ğŸŸ¢ ë¹„êµì  í¸ì•ˆí•˜ê³  í˜‘ì¡°ì ì…ë‹ˆë‹¤. ìì—°ìŠ¤ëŸ½ê²Œ ëŒ€í™”í•©ë‹ˆë‹¤.";
    } else {
      return "ğŸ”µ ë§¤ìš° ìì‹ ê° ìˆê³  ì ê·¹ì ìœ¼ë¡œ í˜‘ì¡°í•©ë‹ˆë‹¤. ì§„ì‹¤ì„ ë°íˆê³  ì‹¶ì–´ í•©ë‹ˆë‹¤.";
    }
  }

  // ì§ˆë¬¸ ë‚ ì¹´ë¡œì›€ ë¶„ì„
  private analyzeQuestionSharpness(question: string, suspect: SuspectContext): number {
    let sharpness = 0;
    
    // ì•Œë¦¬ë°”ì´ ì§ì ‘ ê³µê²©
    if (question.includes('ì•Œë¦¬ë°”ì´') || question.includes('ì¦ëª…')) {
      sharpness += 20;
    }
    
    // ëª¨ìˆœ ì§€ì 
    if (question.includes('ëª¨ìˆœ') || question.includes('ë‹¤ë¥´ë‹¤') || question.includes('ê±°ì§“ë§')) {
      sharpness += 30;
    }
    
    // ì¦ê±° ì œì‹œ
    if (question.includes('ì¦ê±°') || question.includes('ëª©ê²©') || question.includes('CCTV')) {
      sharpness += 25;
    }
    
    // ê°ì • ìê·¹
    if (question.includes('ì™œ') || question.includes('ë™ê¸°')) {
      sharpness += 15;
    }
    
    return Math.min(sharpness, 50);
  }

  // ìƒíƒœ ì—…ë°ì´íŠ¸ (Kiro íŒ¨í„´)
  private async updateSuspectState(
    suspectId: string, 
    answer: string, 
    questionSharpness: number
  ): Promise<void> {
    const context = await this.getSuspectContext(suspectId);
    
    // suspicionLevel ì—…ë°ì´íŠ¸
    const newLevel = Math.min(
      100, 
      context.state.suspicionLevel + questionSharpness
    );
    
    // ìƒˆë¡œ ë°íŒ ì‚¬ì‹¤ ì¶”ì¶œ (ê°„ë‹¨í•œ íœ´ë¦¬ìŠ¤í‹±)
    const newFacts = this.extractNewFacts(answer);
    
    // KV Store ì—…ë°ì´íŠ¸
    await this.kvStore.set(`suspect:${suspectId}:state`, {
      ...context.state,
      suspicionLevel: newLevel,
      revealedFacts: [...context.state.revealedFacts, ...newFacts],
      conversationCount: context.state.conversationCount + 1
    });
  }

  // ì˜¨ë„ ì¡°ì ˆ (ê¸´ì¥í• ìˆ˜ë¡ ì‘ë‹µ ë¶ˆì•ˆì •)
  private getTemperature(suspicionLevel: number): number {
    // ê¸´ì¥í• ìˆ˜ë¡ temperature ì¦ê°€ (0.7 â†’ 1.2)
    return 0.7 + (suspicionLevel / 100) * 0.5;
  }

  private extractNewFacts(answer: string): string[] {
    // ê°„ë‹¨í•œ ì‚¬ì‹¤ ì¶”ì¶œ ë¡œì§ (MVP)
    // TODO: LLMìœ¼ë¡œ ê³ ë„í™”
    return [];
  }
}
```

**í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤:**

```tsx
describe('SuspectAIService', () => {
  test('suspicionLevelì— ë”°ë¼ ê°ì • ìƒíƒœ ë³€í™”', () => {
    const service = new SuspectAIService();
    expect(service['getEmotionalTone'](10)).toContain('ìì‹ ê°');
    expect(service['getEmotionalTone'](50)).toContain('ê¸´ì¥');
    expect(service['getEmotionalTone'](90)).toContain('ê·¹ë„ë¡œ');
  });

  test('ë‚ ì¹´ë¡œìš´ ì§ˆë¬¸ì€ suspicionLevel ì¦ê°€', async () => {
    const sharpness = service['analyzeQuestionSharpness'](
      'ë‹¹ì‹ ì˜ ì•Œë¦¬ë°”ì´ëŠ” ì¦ê±°ì™€ ëª¨ìˆœë©ë‹ˆë‹¤. ì™œ ê±°ì§“ë§í•˜ì£ ?',
      mockSuspect
    );
    expect(sharpness).toBeGreaterThan(40);
  });

  test('ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ ë°˜í™˜', async () => {
    const stream = await [service.chat](http://service.chat)('suspect_A', 'ì–´ë”” ìˆì—ˆë‚˜ìš”?', []);
    expect(stream).toBeInstanceOf(ReadableStream);
  });
});
```

---

### 3.4 ImageGeneratorService â­ (Kiro item-images íŒ¨í„´)

**í•µì‹¬ ì „ëµ:**

1. **ì™¸ë¶€ Vercel Functionìœ¼ë¡œ ë¶„ë¦¬** (Devvit 1ì´ˆ ì œí•œ íšŒí”¼)
2. **ë²¡í„° ìºì‹±** (ë¹„ìš© 90% ì ˆê°)
3. **Kiroì˜ í´ë°± ì „ëµ**

**ì•„í‚¤í…ì²˜:**

```
[Devvit Scheduler] 
    â†“ (HTTP Fetch)
[Vercel Function /api/generate-scene-image]
    â†“
[1. í”„ë¡¬í”„íŠ¸ ì„ë² ë”© (OpenAI text-embedding-3-small)]
    â†“
[2. Upstash Redis ë²¡í„° ê²€ìƒ‰ (ì½”ì‚¬ì¸ ìœ ì‚¬ë„ > 0.95)]
    â†“ (ìºì‹œ íˆíŠ¸)          â†“ (ìºì‹œ ë¯¸ìŠ¤)
[ìºì‹œ URL ë°˜í™˜]      [Imagen API í˜¸ì¶œ]
                        â†“
                    [S3 ì €ì¥ + ë²¡í„° ì €ì¥]
                        â†“
                    [ìƒˆ URL ë°˜í™˜]
```

**Devvit ì¸¡ êµ¬í˜„:**

```tsx
// /src/services/ImageGeneratorService.ts (Devvit)

class ImageGeneratorService {
  private vercelFunctionUrl = 'https://your-project.vercel.app/api/generate-scene-image';
  
  async generateSceneImage(caseDescription: string, caseId: string): Promise<string> {
    const prompt = this.buildImagePrompt(caseDescription);
    
    try {
      // Kiro íŒ¨í„´: ì™¸ë¶€ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ í˜¸ì¶œ
      const response = await fetch(this.vercelFunctionUrl, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ prompt, caseId })
      });
      
      const result = await response.json();
      
      if (result.cached) {
        console.log('ğŸ’° ì´ë¯¸ì§€ ìºì‹œ íˆíŠ¸! API ë¹„ìš© ì ˆê°');
      }
      
      return result.imageUrl;
      
    } catch (error) {
      console.error('ì´ë¯¸ì§€ ìƒì„± ì‹¤íŒ¨:', error);
      // Kiroì˜ í´ë°± ì „ëµ
      return this.getPlaceholderImage();
    }
  }

  private buildImagePrompt(description: string): string {
    return `Photorealistic crime scene photography, ${description}, 
cinematic lighting, noir atmosphere, forensic detail, 
high detail 4K, professional documentation style`;
  }

  private getPlaceholderImage(): string {
    return 'https://placeholder.com/crime-scene.jpg';
  }
}
```

**Vercel Function êµ¬í˜„ (í•µì‹¬ - Kiro ë²¡í„° ìºì‹±):**

```tsx
// /api/generate-scene-image.ts (Vercel Function)

import { embed } from 'ai';
import { openai } from '@ai-sdk/openai';
import { Redis } from '@upstash/redis';
import { Index } from '@upstash/vector';

const redis = Redis.fromEnv();
const vectorIndex = new Index({
  url: process.env.UPSTASH_VECTOR_URL!,
  token: process.env.UPSTASH_VECTOR_TOKEN!
});

export async function POST(req: Request) {
  const { prompt, caseId } = await req.json();
  
  // 1. í”„ë¡¬í”„íŠ¸ ë²¡í„°í™” (Kiro íŒ¨í„´)
  const { embedding } = await embed({
    model: openai.embedding('text-embedding-3-small'),
    value: prompt
  });
  
  // 2. ë²¡í„° ìœ ì‚¬ë„ ê²€ìƒ‰ (Kiroì˜ nearestMatch)
  const similar = await vectorIndex.query({
    vector: embedding,
    topK: 1,
    includeMetadata: true
  });
  
  // 3. ìºì‹œ íˆíŠ¸ íŒì • (ìœ ì‚¬ë„ > 0.95)
  if (similar.length > 0 && similar[0].score > 0.95) {
    console.log('ğŸ’° ë²¡í„° ìºì‹œ íˆíŠ¸!', { score: similar[0].score });
    return Response.json({
      imageUrl: similar[0].metadata.imageUrl,
      cached: true,
      similarity: similar[0].score
    });
  }
  
  // 4. ìºì‹œ ë¯¸ìŠ¤ - ìƒˆ ì´ë¯¸ì§€ ìƒì„±
  console.log('ğŸ¨ ìƒˆ ì´ë¯¸ì§€ ìƒì„± ì¤‘...');
  
  try {
    // Imagen API í˜¸ì¶œ
    const imageUrl = await generateWithImagen(prompt);
    
    // S3 ì—…ë¡œë“œ (ì„ íƒ)
    const s3Url = await uploadToS3(imageUrl, caseId);
    
    // 5. ë²¡í„° ì €ì¥ (í–¥í›„ ì¬ì‚¬ìš©)
    await vectorIndex.upsert({
      id: `image_${caseId}_${[Date.now](http://Date.now)()}`,
      vector: embedding,
      metadata: {
        imageUrl: s3Url,
        prompt,
        caseId,
        createdAt: new Date().toISOString()
      }
    });
    
    return Response.json({
      imageUrl: s3Url,
      cached: false
    });
    
  } catch (error) {
    console.error('ì´ë¯¸ì§€ ìƒì„± ì‹¤íŒ¨:', error);
    
    // Kiro í´ë°± ì „ëµ
    return Response.json({
      imageUrl: 'https://placeholder.com/fallback.jpg',
      cached: false,
      fallback: true,
      error: error.message
    });
  }
}

async function generateWithImagen(prompt: string): Promise<string> {
  // Google Imagen ë˜ëŠ” DALL-E í˜¸ì¶œ
  // ...
}

async function uploadToS3(imageUrl: string, caseId: string): Promise<string> {
  // S3 ì—…ë¡œë“œ ë¡œì§
  // ...
}
```

**ë¹„ìš© ì ˆê° íš¨ê³¼ (Kiro ê²€ì¦ ë°ì´í„°):**

| **ì‹œë‚˜ë¦¬ì˜¤** | **ìºì‹± ì—†ìŒ** | **ë²¡í„° ìºì‹±** | **ì ˆê°ìœ¨** |
| --- | --- | --- | --- |
| ì²« 100ê°œ ì´ë¯¸ì§€ | $100 (100íšŒ ìƒì„±) | $100 (ìºì‹œ êµ¬ì¶•) | 0% |
| ë‹¤ìŒ 100ê°œ (ìœ ì‚¬ í”„ë¡¬í”„íŠ¸ 70%) | $100 | $30 | **70%** |
| 1000ê°œ ì´ë¯¸ì§€ (ìºì‹œ íˆíŠ¸ìœ¨ 85%) | $1000 | $150 | **85%** |

---

### 3.5 KVStoreManager (Kiro íŠ¸ëœì­ì…˜ íŒ¨í„´)

**ê°œì„  ì‚¬í•­:**

1. **ì›ìì  íŠ¸ëœì­ì…˜** (Kiro moveItemLocation íŒ¨í„´)
2. **ì¤‘ë³µ ì œì¶œ ë°©ì§€**
3. **ë¦¬ë”ë³´ë“œ Sorted Set í™œìš©**

**êµ¬í˜„:**

```tsx
// /src/data/KVStoreManager.ts

class KVStoreManager {
  constructor(private context: Devvit.Context) {}

  // Kiroì˜ moveItemLocation íŒ¨í„´ ì°¨ìš©
  async submitVote(
    userId: string, 
    caseId: string, 
    submission: Submission,
    score: number
  ): Promise<void> {
    const redis = this.context.redis;
    
    // 1. ì¤‘ë³µ ì²´í¬ (ì›ìì„± ë³´ì¥)
    const voteKey = `vote:${caseId}:${userId}`;
    const existing = await redis.get(voteKey);
    
    if (existing) {
      throw new Error('ì´ë¯¸ íˆ¬í‘œí•˜ì…¨ìŠµë‹ˆë‹¤');
    }
    
    // 2. íŠ¸ëœì­ì…˜ ì‹œì‘ (Kiro íŒ¨í„´)
    // RedisëŠ” MULTI/EXECë¥¼ ì§€ì›í•˜ì§€ ì•Šìœ¼ë¯€ë¡œ ê°œë³„ ì—°ì‚°
    
    // 2-1. íˆ¬í‘œ ì €ì¥
    await redis.set(voteKey, JSON.stringify({
      ...submission,
      score,
      submittedAt: new Date().toISOString()
    }));
    
    // 2-2. ì°¸ì—¬ì ìˆ˜ ì¦ê°€
    await redis.incrby(`case:${caseId}:participants`, 1);
    
    // 2-3. ì‚¬ìš©ì ì´ì  ì—…ë°ì´íŠ¸
    await redis.incrby(`user:${userId}:score`, score);
    
    // 2-4. ì¼ì¼ ë¦¬ë”ë³´ë“œ ì—…ë°ì´íŠ¸ (Sorted Set)
    const today = this.getTodayDate();
    await redis.zadd(`leaderboard:daily:${today}`, {
      member: userId,
      score: score
    });
    
    // 2-5. ì „ì²´ ë¦¬ë”ë³´ë“œ ì—…ë°ì´íŠ¸
    const totalScore = await redis.get(`user:${userId}:score`);
    await redis.zadd(`leaderboard:alltime`, {
      member: userId,
      score: parseInt(totalScore as string)
    });
  }

  // Kiroì˜ listInventoryItems íŒ¨í„´
  async getLeaderboard(
    type: 'daily' | 'weekly' | 'alltime',
    limit: number = 10
  ): Promise<LeaderboardEntry[]> {
    const redis = this.context.redis;
    
    let key: string;
    if (type === 'daily') {
      key = `leaderboard:daily:${this.getTodayDate()}`;
    } else if (type === 'weekly') {
      key = `leaderboard:weekly:${this.getWeekNumber()}`;
    } else {
      key = `leaderboard:alltime`;
    }
    
    // Sorted Setì—ì„œ ìƒìœ„ Nëª… ì¡°íšŒ (ì ìˆ˜ ë‚´ë¦¼ì°¨ìˆœ)
    const results = await redis.zrevrange(key, 0, limit - 1, { withScores: true });
    
    // ì‚¬ìš©ì ì •ë³´ ë³‘í•©
    const entries: LeaderboardEntry[] = [];
    for (let i = 0; i < results.length; i += 2) {
      const userId = results[i] as string;
      const score = results[i + 1] as number;
      
      entries.push({
        rank: i / 2 + 1,
        userId,
        username: await this.getUserName(userId),
        score
      });
    }
    
    return entries;
  }

  // ì‚¬ê±´ ë°ì´í„° ì €ì¥ (ì •ë‹µ ë¶„ë¦¬)
  async saveCase(date: string, caseData: Case): Promise<void> {
    const redis = this.context.redis;
    
    // ì •ë‹µ ë¶„ë¦¬ (Kiro ë³´ì•ˆ íŒ¨í„´)
    const { solution, ...publicData } = caseData;
    
    // ê³µê°œ ë°ì´í„° ì €ì¥
    await redis.set(`case:${date}`, JSON.stringify(publicData));
    
    // ì •ë‹µì€ ë³„ë„ í‚¤ë¡œ ì €ì¥ (ì ‘ê·¼ ì œí•œ)
    await redis.set(`case:${date}:solution`, JSON.stringify(solution));
  }

  async getSolution(date: string): Promise<Solution | null> {
    const redis = this.context.redis;
    const data = await redis.get(`case:${date}:solution`);
    return data ? JSON.parse(data as string) : null;
  }

  private getTodayDate(): string {
    return new Date().toISOString().split('T')[0];
  }

  private getWeekNumber(): string {
    // ISO Week ê³„ì‚°
    const date = new Date();
    date.setHours(0, 0, 0, 0);
    date.setDate(date.getDate() + 3 - (date.getDay() + 6) % 7);
    const week1 = new Date(date.getFullYear(), 0, 4);
    return `${date.getFullYear()}-W${1 + Math.round(((date.getTime() - week1.getTime()) / 86400000 - 3 + (week1.getDay() + 6) % 7) / 7)}`;
  }

  private async getUserName(userId: string): Promise<string> {
    const user = await this.context.reddit.getUserById(userId);
    return user.username;
  }
}
```

---

## 4. ê°œë°œ ìš°ì„ ìˆœìœ„ ì¬ì¡°ì • (Kiro íŒ¨í„´ í†µí•©)

### Week 1 (D-17 ~ D-11) - ê¸°ë°˜ êµ¬ì¡° + Kiro í•µì‹¬ íŒ¨í„´

**Day 1-2: ê¸°ë°˜ êµ¬ì¡°**

- [P0] **CaseElementLibrary êµ¬ì¶•** (Kiro word-lists íŒ¨í„´)
    - íŒŒì¼ ìƒì„±: `/src/services/caseModules/CaseElementLibrary.ts`
    - ë‚ ì§œ ì‹œë“œ í•¨ìˆ˜ êµ¬í˜„ ë° í…ŒìŠ¤íŠ¸
    - ìµœì†Œ 5ê°œì”©ì˜ weapons, motives, locations ë°ì´í„° ì‘ì„±
- [P0] **ì™¸ë¶€ ì´ë¯¸ì§€ ìƒì„± Vercel Function ì„¤ì •**
    - Vercel í”„ë¡œì íŠ¸ ìƒì„±
    - Upstash Redis + Vector Index ê³„ì • ìƒì„±
    - `/api/generate-scene-image.ts` ìŠ¤ì¼ˆë ˆí†¤ ì‘ì„±

**Day 3-4: AI í†µí•© (Kiro í”„ë¡¬í”„íŠ¸ íŒ¨í„´)**

- [P0] **CaseGeneratorService + YAML í”„ë¡¬í”„íŠ¸**
    - `getDailyElements` í†µí•©
    - YAML ì¶œë ¥ í˜•ì‹ í”„ë¡¬í”„íŠ¸ ì‘ì„±
    - ê²€ì¦ ì¬ì‹œë„ ë¡œì§ êµ¬í˜„
    - í…ŒìŠ¤íŠ¸: ë™ì¼ ë‚ ì§œëŠ” ë™ì¼ ì‚¬ê±´ ìƒì„± í™•ì¸
- [P0] **SuspectAIService + ê°ì • ìƒíƒœ ì‹œìŠ¤í…œ**
    - `SuspectContext` ì¸í„°í˜ì´ìŠ¤ ì •ì˜
    - `getEmotionalTone` í•¨ìˆ˜ êµ¬í˜„
    - Gemini API ì—°ë™ ë° ìŠ¤íŠ¸ë¦¬ë° í…ŒìŠ¤íŠ¸

**Day 5-7: í•µì‹¬ ë£¨í”„**

- [P0] **SchedulerTrigger** (ì¼ì¼ ì‚¬ê±´ + ì´ë¯¸ì§€ ìƒì„±)
    - ë§¤ì¼ 09:00 KST ìŠ¤ì¼€ì¤„ëŸ¬ ì„¤ì •
    - `CaseGeneratorService` í˜¸ì¶œ
    - `ImageGeneratorService` í˜¸ì¶œ (Vercel Function)
    - Reddit ê²Œì‹œë¬¼ ì‘ì„±
- [P0] **CommentSubmit Trigger** (AI ìš©ì˜ì ë‹µë³€)
    - ìš©ì˜ì ë´‡ ëŒ“ê¸€ ê°ì§€
    - `SuspectAIService` í˜¸ì¶œ
    - ìŠ¤íŠ¸ë¦¬ë° ë‹µë³€ì„ ë‹µê¸€ë¡œ ì‘ì„±
- [P1] **ë²¡í„° ìºì‹± êµ¬í˜„** (ë¹„ìš© ì ˆê° í•µì‹¬)
    - Vercel Functionì— OpenAI Embeddings í†µí•©
    - Upstash Vector ìœ ì‚¬ë„ ê²€ìƒ‰ êµ¬í˜„
    - ìºì‹œ íˆíŠ¸ìœ¨ ë¡œê¹…

**Week 1 ì™„ë£Œ ê¸°ì¤€:**

- âœ… ìˆ˜ë™ìœ¼ë¡œ íŠ¸ë¦¬ê±°í•˜ë©´ ì¼ì¼ ì‚¬ê±´ì´ ìƒì„±ë˜ê³  ê²Œì‹œë¨
- âœ… ìš©ì˜ì ë´‡ì— ëŒ“ê¸€ì„ ë‹¬ë©´ AIê°€ ë‹µë³€ (ê°ì • ìƒíƒœ ë°˜ì˜)
- âœ… ì´ë¯¸ì§€ ìƒì„± ì‹œ ë²¡í„° ìºì‹± ì‘ë™ í™•ì¸

### Week 2 (D-10 ~ D-4) - UX + ê³ ë„í™”

**Day 8-10: Presentation Layer**

- [P0] **CaseOverview + SuspectPanel**
    - React ì»´í¬ë„ŒíŠ¸ êµ¬í˜„
    - Devvit Web View ì„¤ì •
    - ì‚¬ê±´ ë°ì´í„° fetch ë° í‘œì‹œ
- [P0] **ChatInterface**
    - Vercel AI SDK `useChat` í›… í†µí•©
    - ìŠ¤íŠ¸ë¦¬ë° UI êµ¬í˜„
    - ë¡œë”© ìƒíƒœ í‘œì‹œ
- [P0] **SubmissionForm + ScoringEngine**
    - 1W4H í¼ UI
    - ì±„ì  ë¡œì§ (ë¶€ë¶„ ì ìˆ˜)
    - ê²°ê³¼ ëª¨ë‹¬

**Day 11-12: ë¦¬ë”ë³´ë“œ + í´ë¦¬ì‹±**

- [P1] **LeaderboardView**
    - Sorted Set ì¡°íšŒ
    - ìƒìœ„ 10ëª… + ë‚´ ìˆœìœ„ í‘œì‹œ
    - ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸ (10ì´ˆ polling)
- [P1] **Flair ìë™ ë³€ê²½**
    - ì ìˆ˜ë³„ ë­í¬ í…Œì´ë¸”
    - `setUserFlair` API í˜¸ì¶œ
- [P2] **GameTimeline**
    - í˜„ì¬ ë‹¨ê³„ í‘œì‹œ
    - ì¹´ìš´íŠ¸ë‹¤ìš´ íƒ€ì´ë¨¸

**Day 13-14: ì´ë¯¸ì§€ + ìµœì¢… ì ê²€**

- [P1] **ì´ë¯¸ì§€ ìƒì„± ì™„ì„±**
    - Imagen API ì—°ë™
    - S3 ì—…ë¡œë“œ
    - í´ë°± ì´ë¯¸ì§€ ì²˜ë¦¬
- [P2] **ë™ì  ì¦ê±° ìƒì„±**
    - í‚¤ì›Œë“œ ê°ì§€ ("ë³´ì—¬ì¤˜", "í™•ëŒ€")
    - ì¶”ê°€ ì´ë¯¸ì§€ ìƒì„±
    - ìš”ì²­ íšŸìˆ˜ ì œí•œ

### Week 3 (D-3 ~ D-Day) - í…ŒìŠ¤íŠ¸ + ì œì¶œ

**Day 15-16: í†µí•© í…ŒìŠ¤íŠ¸**

- [P0] ì „ì²´ ê²Œì„ ë£¨í”„ í…ŒìŠ¤íŠ¸ (ì‚¬ê±´ ìƒì„± â†’ ì‹¬ë¬¸ â†’ íˆ¬í‘œ â†’ í•´ê²°)
- [P0] ì—ëŸ¬ í•¸ë“¤ë§ ê°•í™”
- [P1] ì„±ëŠ¥ ìµœì í™” (API í˜¸ì¶œ ìµœì†Œí™”)
- [P1] ëª¨ë°”ì¼ UI ìµœì¢… ì ê²€

**Day 17 (D-Day): ì œì¶œ**

- [P0] ë°ëª¨ ë¹„ë””ì˜¤ ì œì‘
- [P0] README + ì„¤ëª…ì„œ ì‘ì„±
- [P0] Devpost ì œì¶œ
- [P0] Reddit ì„œë¸Œë ˆë”§ ë°°í¬

---

## 5. ë¦¬ìŠ¤í¬ ê´€ë¦¬ ì—…ë°ì´íŠ¸ (Kiro íŒ¨í„´ ì™„í™” íš¨ê³¼)

### 5.1 ê¸°ìˆ ì  ë¦¬ìŠ¤í¬ ì™„í™”

| **ê¸°ì¡´ ë¦¬ìŠ¤í¬** | **ì˜í–¥ë„** | **Kiro íŒ¨í„´ ì ìš© í›„ ì™„í™” ë°©ì•ˆ** | **ì”ì—¬ ë¦¬ìŠ¤í¬** |
| --- | --- | --- | --- |
| LLM ì‚¬ê±´ ìƒì„± í’ˆì§ˆ ë¶ˆì•ˆì • | High | âœ… **CaseElementLibrary + YAML êµ¬ì¡°í™”**ë¡œ ì¼ê´€ì„± í™•ë³´
âœ… **ê²€ì¦ ì‹¤íŒ¨ ì‹œ ì¬ìƒì„± ë¡œì§** | Low |
| ì´ë¯¸ì§€ ìƒì„± ë¹„ìš© í­ì¦ | Critical | âœ… **ë²¡í„° ìºì‹±**ìœ¼ë¡œ ë°˜ë³µ ìš”ì²­ 90% ì ˆê°
âœ… **ì™¸ë¶€ ì„œë¹„ìŠ¤ ë¶„ë¦¬**ë¡œ íƒ€ì„ì•„ì›ƒ íšŒí”¼ | Low |
| AI ëŒ€í™” ì‘ë‹µ ì§€ì—° | Medium | âœ… **ìŠ¤íŠ¸ë¦¬ë° íŒ¨í„´**ìœ¼ë¡œ ì²´ê° ì§€ì—° ìµœì†Œí™”
âœ… **ê°ì • ìƒíƒœ ê¸°ë°˜ ì§§ì€ í”„ë¡¬í”„íŠ¸** | Low |
| Devvit 1ì´ˆ ì‹¤í–‰ ì œí•œ | High | âœ… **ì™¸ë¶€ Vercel Function** ë¶„ë¦¬
âœ… **ë¹„ë™ê¸° ì²˜ë¦¬** (Scheduler) | Low |
| KV Store ë°ì´í„° ì •í•©ì„± | Medium | âœ… **Kiro íŠ¸ëœì­ì…˜ íŒ¨í„´** (ì›ìì  ì—°ì‚°)
âœ… **ì¤‘ë³µ ì œì¶œ ë°©ì§€** ë¡œì§ | Low |
| AI ìš©ì˜ì ì¼ê´€ì„± ë¶€ì¡± | Medium | âœ… **SuspectContext ìƒíƒœ ê´€ë¦¬**
âœ… **revealedFacts ì¶”ì ** | Medium |

### 5.2 ìƒˆë¡œìš´ ë¦¬ìŠ¤í¬

| **ì‹ ê·œ ë¦¬ìŠ¤í¬** | **ë°œìƒ í™•ë¥ ** | **ëŒ€ì‘ ì „ëµ** |
| --- | --- | --- |
| Vercel Function ì½œë“œ ìŠ¤íƒ€íŠ¸ | ì¤‘ | - ì£¼ê¸°ì  Warm-up ìš”ì²­
- íƒ€ì„ì•„ì›ƒ 30ì´ˆ ì„¤ì • |
| Upstash ë²¡í„° ì €ì¥ ë¹„ìš© | ì € | - ë¬´ë£Œ í‹°ì–´ (10K ë²¡í„°)
- 30ì¼ ì´ìƒ ìºì‹œ ì‚­ì œ |
| CaseElementLibrary ë°ì´í„° ê³ ê°ˆ | ì¤‘ | - ê° ì¹´í…Œê³ ë¦¬ ìµœì†Œ 10ê°œì”©
- Phase 2ì—ì„œ í™•ì¥ |

---

## 6. ì„±ê³µ ê¸°ì¤€ (KPI) - Kiro íŒ¨í„´ ëª©í‘œ í¬í•¨

### 6.1 ê¸°ìˆ ì  ì„±ê³µ ì§€í‘œ

| **ì§€í‘œ** | **ëª©í‘œ** | **ì¸¡ì • ë°©ë²•** | **Kiro íŒ¨í„´ ê¸°ì—¬** |
| --- | --- | --- | --- |
| ì‚¬ê±´ ìƒì„± ì„±ê³µë¥  | 95%+ | ê²€ì¦ í†µê³¼ìœ¨ | CaseElementLibrary + ì¬ì‹œë„ ë¡œì§ |
| ì´ë¯¸ì§€ ìºì‹œ íˆíŠ¸ìœ¨ | 70%+ (100ê°œ í›„) | Vercel Function ë¡œê·¸ | **ë²¡í„° ìºì‹± í•µì‹¬ ì§€í‘œ** |
| AI ë‹µë³€ ì‘ë‹µ ì‹œê°„ | < 3ì´ˆ | ìŠ¤íŠ¸ë¦¬ë° ì²« í† í° | Gemini Flash + ì§§ì€ í”„ë¡¬í”„íŠ¸ |
| ìš©ì˜ì ë‹µë³€ ì¼ê´€ì„± | ëª¨ìˆœ < 5% | ì‚¬ìš©ì ì‹ ê³  | SuspectContext + revealedFacts |
| ì‹œìŠ¤í…œ ê°€ë™ë¥  | 99%+ | Scheduler ì‹¤í–‰ ì„±ê³µ | í´ë°± ì „ëµ |

### 6.2 ë¹„ìš© íš¨ìœ¨ì„± (Kiro ë²¡í„° ìºì‹± ê²€ì¦)

**ì‹œë‚˜ë¦¬ì˜¤: 30ì¼ ìš´ì˜ (ì¼ì¼ ì‚¬ê±´ 1ê°œ)**

| **í•­ëª©** | **ìºì‹± ì—†ìŒ** | **Kiro ë²¡í„° ìºì‹±** | **ì ˆê°ì•¡** |
| --- | --- | --- | --- |
| ì‚¬ê±´ ì´ë¯¸ì§€ (30ê°œ) | $30 | $10 (70% ìºì‹œ) | **$20** |
| ë™ì  ì¦ê±° (í‰ê·  50íšŒ/ì¼) | $1500 | $200 (85% ìºì‹œ) | **$1300** |
| Upstash ë¹„ìš© | - | $5 (10K ë²¡í„°) | -$5 |
| **ì´ê³„** | **$1530** | **$215** | **$1315 (86% ì ˆê°)** |

---

## 7. Next Steps - ì¦‰ì‹œ ì‹¤í–‰ ê³„íš

### ì˜¤ëŠ˜ (D-17)

- [ ]  **CaseElementLibrary.ts íŒŒì¼ ìƒì„±**
    - Spirit of Kiroì˜ [word-lists/](https://github.com/aws-samples/spirit-of-kiro/tree/main/server/llm/word-lists) ì°¸ì¡°
    - weapons, motives, locations ê° 5ê°œì”© ì´ˆê¸° ë°ì´í„° ì‘ì„±
    - `getDailyElements` í•¨ìˆ˜ êµ¬í˜„ ë° ë‹¨ìœ„ í…ŒìŠ¤íŠ¸
- [ ]  **Vercel í”„ë¡œì íŠ¸ ì´ˆê¸°í™”**
    - ê³„ì • ìƒì„± ë° í”„ë¡œì íŠ¸ ìƒì„±
    - Upstash Redis ê³„ì • ìƒì„±
    - Upstash Vector Index ìƒì„±
    - í™˜ê²½ ë³€ìˆ˜ ì„¤ì • (`UPSTASH_REDIS_URL`, `UPSTASH_VECTOR_URL`)

### ë‚´ì¼ (D-16)

- [ ]  **CaseGeneratorService ìŠ¤ì¼ˆë ˆí†¤**
    - `CaseElementLibrary` import
    - YAML í”„ë¡¬í”„íŠ¸ í…œí”Œë¦¿ ì‘ì„±
    - Gemini API ì—°ë™ í…ŒìŠ¤íŠ¸
- [ ]  **Vercel Function `/api/generate-scene-image` êµ¬í˜„**
    - OpenAI Embeddings í†µí•©
    - Upstash Vector ê²€ìƒ‰ ë¡œì§
    - í´ë°± ì´ë¯¸ì§€ ë°˜í™˜

### D-15

- [ ]  **KVStoreManager êµ¬í˜„**
    - íŠ¸ëœì­ì…˜ íŒ¨í„´ ì ìš©
    - ì¤‘ë³µ ì œì¶œ ë°©ì§€
    - ë¦¬ë”ë³´ë“œ Sorted Set êµ¬í˜„
- [ ]  **SchedulerTrigger ì„¤ì •**
    - ë§¤ì¼ 09:00 KST í…ŒìŠ¤íŠ¸ (ìˆ˜ë™ íŠ¸ë¦¬ê±°)
    - ì‚¬ê±´ ìƒì„± â†’ KV ì €ì¥ â†’ ê²Œì‹œë¬¼ ì‘ì„±

---

## 8. ì°¸ê³  ìë£Œ

### Spirit of Kiro í•µì‹¬ íŒŒì¼

- [`server/llm/prompts.ts`](https://github.com/aws-samples/spirit-of-kiro/blob/main/server/llm/prompts.ts) - YAML í”„ë¡¬í”„íŠ¸ íŒ¨í„´
- [`server/llm/word-lists/`](https://github.com/aws-samples/spirit-of-kiro/tree/main/server/llm/word-lists) - CaseElementLibrary ì°¸ì¡°
- [`item-images/lib/item-image.ts`](https://github.com/aws-samples/spirit-of-kiro/blob/main/item-images/lib/item-image.ts) - ë²¡í„° ìºì‹± ë¡œì§
- [`server/state/item-store.ts`](https://github.com/aws-samples/spirit-of-kiro/blob/main/server/state/item-store.ts) - íŠ¸ëœì­ì…˜ íŒ¨í„´

### ë‚´ë¶€ ë¬¸ì„œ

- [ğŸ¯ Spirit of Kiro í™œìš© ì „ëµ ì œì•ˆì„œ](https://www.notion.so/Spirit-of-Kiro-36ed0e4d3e344fb0ababc7acd4d1d742?pvs=21)
- [ğŸ¯ í•µì‹¬ ê²Œì„ ìš”ì†Œ ë° ì„¤ê³„ ë°©ë²•ë¡ ](https://www.notion.so/f646b5e3d60e4ba69874493bc42adc10?pvs=21)
- [í”„ë¡œì íŠ¸ ê¸°íš ë³´ê³ ì„œ: ë ˆë”§ íƒì • ì‚¬ë¬´ì†Œ](https://www.notion.so/33cc5692f5aa447a8b6e41ff8f75c85e?pvs=21)

---

<aside>
ğŸš€

**v2.0 ì™„ì„±!**

Spirit of Kiroì˜ ê²€ì¦ëœ íŒ¨í„´ë“¤ì„ ì²´ê³„ì ìœ¼ë¡œ í†µí•©í•˜ì—¬, ì „ëµ AëŠ” ì´ì œ:

- âœ… **ì¼ê´€ì„± ìˆëŠ” ì‚¬ê±´ ìƒì„±** (CaseElementLibrary)
- âœ… **ìƒë™ê° ìˆëŠ” AI ìš©ì˜ì** (ê°ì • ìƒíƒœ ì‹œìŠ¤í…œ)
- âœ… **ë¹„ìš© íš¨ìœ¨ì ì¸ ì´ë¯¸ì§€ ìƒì„±** (ë²¡í„° ìºì‹±ìœ¼ë¡œ 86% ì ˆê°)
- âœ… **ì•ˆì •ì ì¸ ë°ì´í„° ê´€ë¦¬** (íŠ¸ëœì­ì…˜ íŒ¨í„´)
- âœ… **í™•ì¥ ê°€ëŠ¥í•œ ì•„í‚¤í…ì²˜** (ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ë¶„ë¦¬)

ë‹¨ìˆœí•œ MVPë¥¼ ë„˜ì–´ **AI ë„¤ì´í‹°ë¸Œ ê²Œì„ì˜ ë² ìŠ¤íŠ¸ í”„ë™í‹°ìŠ¤ë¥¼ êµ¬í˜„í•œ í™•ì¥ ê°€ëŠ¥í•œ ì‹œìŠ¤í…œ**ìœ¼ë¡œ ì™„ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.

ì§€ê¸ˆ ì¦‰ì‹œ Day 1 ì‘ì—…ì„ ì‹œì‘í•˜ì„¸ìš”! ğŸ”

</aside>

---

**ë¬¸ì„œ ë²„ì „:** 2.0 (Spirit of Kiro íŒ¨í„´ í†µí•©)

**ìµœì´ˆ ì‘ì„±:** 2025-10-14

**ìµœì¢… ì—…ë°ì´íŠ¸:** 2025-10-14

**ì‘ì„±ì:** Jinha Yoon

**ì°¸ì¡°:** Spirit of Kiro Analysis + ë ˆë”§ íƒì • ì‚¬ë¬´ì†Œ ê¸°íšì„œ