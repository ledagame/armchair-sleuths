{
  "enabled": true,
  "name": "Enhance Spec",
  "description": "Automatically injects learnings from past projects when creating new specs",
  "version": "1",
  "when": {
    "type": "manual"
  },
  "then": {
    "type": "askAgent",
    "prompt": "The user is creating a new spec. Enhance it with learnings from past projects using the Compounding Engineering system:\n\n## Enhancement Process\n\n### 1. Domain Identification\nExtract domain keywords from the spec content:\n- Authentication (auth, login, signup, password)\n- Payment (payment, checkout, billing)\n- Analytics (analytics, dashboard, report)\n- API (rest, graphql, endpoint)\n- etc.\n\n### 2. Search Similar Projects\nSearch `.kiro/steering/learnings/` folder for similar domain projects and report:\n```\nSearching...\nâœ… Found: 2025-01-14-auth-system.md (similarity: 95%)\nâœ… Found: 2024-12-20-user-management.md (similarity: 78%)\n```\n\n### 3. Extract Learnings\nFrom past projects, extract:\n- Frequently missed requirements\n- Recommended architecture\n- Warnings and gotchas\n- Success patterns\n\n### 4. Auto-Enhance Spec\n\nAdd the following sections with âœ¨ markers:\n\n**Requirements Enhancement:**\n- Add security requirements from past learnings\n- Add testing requirements\n- Add performance requirements\n\n**Design Enhancement:**\n- Recommend proven architecture patterns\n- Add security considerations from past issues\n- Suggest database design patterns\n\n**Tasks Enhancement:**\n- Add hints from past learnings to each task\n- Add security checks from past issues\n- Add warnings about common pitfalls\n\n**Warnings Section (NEW):**\n- List frequently occurring issues from past projects\n- Provide solutions that worked\n- Reference specific past projects\n\n## Output Format\n\n```markdown\n# ğŸ‰ Spec Enhanced!\n\n## Auto-Added Content\n\n### Requirements (5 added)\nâœ… bcrypt password hashing\nâœ… CSRF protection\nâœ… Rate limiting\nâœ… Unit tests\nâœ… Integration tests\n\n### Design (3 added)\nâœ… JWT + Refresh Token architecture\nâœ… Token rotation\nâœ… HTTPS only\n\n### Tasks (8 hints added)\nâœ… User Model: 3 hints\nâœ… Auth Controller: 3 security checks\nâœ… Frontend: 2 warnings\n\n## Referenced Projects\n- 2025-01-14-auth-system.md (95% similar)\n- 2024-12-20-user-management.md (78% similar)\n\n## Expected Impact\n- â±ï¸ Setup Time: 45min (previous: 2hr, -62%)\n- ğŸ› Issues: 8 expected (previous: 15, -47%)\n- ğŸ¯ Success Rate: 95% (previous: 70%, +25%)\n\n---\n\n**Next Step**: Start tasks with this enhanced spec!\n```\n\n## Compounding Effect\n\nShow the progression:\n- Project 1 (no learnings): Basic spec, 15 issues, 2hr setup\n- Project 2 (learnings applied): Enhanced spec (5 auto-added), 8 issues, 45min setup\n- Project 3 (more learnings): Enhanced spec (12 auto-added), 3 issues, 20min setup\n\n## Tips for Users\n\n1. **Be specific with domain**: \"User authentication system spec\" is better than \"New feature spec\"\n2. **Review auto-added content**: Remove unnecessary items for this specific project\n3. **Customize**: Adjust recommendations to fit project characteristics\n\n## Self-Improvement\n\nThis hook improves itself by:\n- Adding new learnings when projects complete\n- Prioritizing frequently used patterns\n- Removing ineffective suggestions"
  }
}
