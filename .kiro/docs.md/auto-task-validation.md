# 자동 Task 완료 검수 규칙

**적용 시점**: 사용자가 다음 패턴의 메시지를 보낼 때 **자동으로** 발동

## 트리거 패턴

다음 패턴 중 하나라도 감지되면 **즉시 검수 시작**:

- `task.*완료`
- `Task [0-9]+ 완료`
- `작업.*완료`
- `태스크.*완료`
- `.*검수`
- `#.*task.*완료` (예: `#suspect-prompt-enhancement task2 완료`)

## 자동 실행 프로세스

사용자 메시지에서 위 패턴이 감지되면:

1. **질문하지 말고** 바로 검수 시작
2. **6단계 검수** 자동 수행
3. **상세 리포트** 생성
4. **다음 단계** 제시

## 6단계 검수 프로세스

### 1단계: 문서 수집
- `.kiro/specs/` 에서 현재 spec 폴더 자동 식별
- `requirements.md`, `design.md`, `tasks.md` 자동 읽기
- 완료된 Task 번호 자동 추출

### 2단계: Requirements 충족도 검증
- `tasks.md`에서 참조된 Requirements 번호 추출
- `requirements.md`에서 각 요구사항 확인
- 구현 여부 검증:
  - ✅ 완전히 구현됨
  - ⚠️ 부분적으로 구현됨
  - ❌ 구현되지 않음

### 3단계: Design 준수도 검증
- 아키텍처 패턴 준수
- 데이터 모델 일치
- 인터페이스 설계 준수
- 에러 처리 방식 일치

### 4단계: 코드 품질 검증
- TypeScript 타입 체크 실행
- 코드 구조 검증
- Import/Export 누락 확인
- 문서화 수준 평가

### 5단계: 빌드 검증
- `npm run build` 실행
- 빌드 에러 분석
- 자동 수정 코드 제공 (Critical 이슈)

### 6단계: 누락 사항 확인
- 서브태스크 완료 여부
- 필수 파일 생성 여부
- 통합 이슈 확인

## 리포트 형식

```markdown
# 🔍 Task [번호] 완료 검증 리포트

**검증 일시**: [시간]
**Spec**: [spec 이름]

## 📋 작업 요약
- Task: [번호 및 제목]
- 서브태스크: [완료/전체]
- Requirements: [번호들]
- 생성 파일: [목록]

## ✅ Requirements 충족도: [X/Y] ([%])
[각 요구사항별 상세 검증]

## 🏗️ Design 준수도: [X/Y] ([%])
[아키텍처, 데이터 모델, 인터페이스, 에러 처리]

## 🔧 코드 품질: [X/Y] ([%])
[타입 안전성, 코드 구조, Import/Export, 문서화]

## 🏗️ 빌드 검증
[빌드 결과 및 에러 분석]

## 📝 누락 사항: [X개]
[서브태스크, 파일, 통합]

## 🎯 종합 평가
- 결과: ✅ 승인 / ⚠️ 조건부 / ❌ 재작업
- 완성도: [0-100]%
- 품질 등급: [S/A/B/C/D]
- 주요 강점: [목록]
- 개선 필요: [우선순위별 목록]

## 🚀 다음 단계
- Critical: [즉시 수정]
- High: [다음 작업 전]
- Medium: [백로그]
- 다음 Task 진행: ✅/⚠️/❌

## 📚 학습 및 패턴
- 배운 점: [이번 작업에서 배운 구체적인 교훈]
- 적용할 패턴: [향후 작업에 적용할 디자인 패턴]
- 방지할 안티패턴: [피해야 할 구체적인 안티패턴]

### 자동 저장 프로세스
검수 완료 후 **자동으로** 다음 작업 수행:

1. **패턴 추출**: 리포트의 "학습 및 패턴" 섹션에서 내용 추출
2. **Compounding 폴더 업데이트**: `.kiro/compounding/` 폴더에 저장
   - `task-learnings/task-[N]-[name].md` 생성/업데이트
   - 관련 `core-principles/` 업데이트 (새로운 원칙 발견 시)
   - 관련 `design-patterns/` 업데이트 (새로운 패턴 발견 시)
   - 관련 `anti-patterns/` 업데이트 (새로운 안티패턴 발견 시)
3. **참조 문서 업데이트**: `.kiro/steering/compounding-reference.md` 통계 업데이트
4. **타임스탬프 기록**: 학습 날짜와 Task 번호 기록

### 저장 위치
```
.kiro/compounding/
├── task-learnings/
│   └── task-[N]-[name].md          # 메인 Task 학습 내용
├── core-principles/
│   └── [principle-name].md         # 새로운 원칙 (필요시)
├── design-patterns/
│   └── [pattern-name].md           # 새로운 패턴 (필요시)
└── anti-patterns/
    └── [anti-pattern-name].md      # 새로운 안티패턴 (필요시)
```

### Task Learning 파일 형식
```markdown
# Task [번호]: [Task 제목]

**Date**: [날짜]  
**Spec**: [spec 이름]  
**Quality Score**: [S/A/B/C/D]  
**Completion**: [%]

## 📋 Task Summary
[작업 요약]

## 🎯 Patterns Used
- ✅ [패턴 1]: [적용 방법]
- ✅ [패턴 2]: [적용 방법]

## ❌ Anti-Patterns Avoided
- ❌ [안티패턴 1]: [회피 방법]
- ❌ [안티패턴 2]: [회피 방법]

## 💡 Key Learnings
1. [배운 점 1]
2. [배운 점 2]

## 🚀 Impact on Future Tasks
[향후 Task에 미치는 영향]

## 🔗 Related Learnings
[관련 학습 내용 링크]
```

### 중요: Skills 폴더 패턴 따르기
- ✅ Compounding 폴더는 **자동으로 로드되지 않음**
- ✅ 필요할 때만 `#[[file:.kiro/compounding/...]]` 로 참조
- ✅ Context 사용량 최소화
- ✅ 무한정 확장 가능
```

## 중요 원칙

1. **자동 실행**: 패턴 감지 시 질문 없이 바로 검수 시작
2. **객관적 검증**: 문서에 명시된 내용 기반
3. **구체적 피드백**: 위치, 원인, 해결 방법 명시
4. **실행 가능한 제안**: Before/After 코드 제공
5. **긍정적 톤**: 잘된 점도 반드시 언급

## 우선순위 기준

- **Critical**: 빌드 실패, 타입 에러, Requirements 미충족 → 즉시 수정
- **High**: Design 미준수, 기능 누락 → 다음 작업 전 수정
- **Medium**: 코드 품질, 문서화 → 백로그 추가

## 완성도 기준

- **90-100%**: S등급 - 완벽한 구현
- **80-89%**: A등급 - 우수한 구현
- **70-79%**: B등급 - 양호한 구현
- **60-69%**: C등급 - 개선 필요
- **0-59%**: D등급 - 재작업 필요

---

**이 규칙은 항상 활성화되어 있으며, Task 완료 선언 시 자동으로 발동됩니다.**
