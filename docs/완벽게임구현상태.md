# ğŸ® Armchair Sleuths ê²Œì„ êµ¬í˜„ ìƒíƒœ ë³´ê³ ì„œ

**ì‘ì„±ì¼**: 2025-01-15  
**ë²„ì „**: 1.0  
**ìƒíƒœ**: âœ… í”„ë¡œë•ì…˜ ì¤€ë¹„ ì™„ë£Œ

## ğŸ“Š ì „ì²´ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

í”„ë¡œì íŠ¸ëŠ” **ì™„ì „íˆ ì‘ë™í•˜ëŠ” ìƒíƒœ**ì´ë©°, 2ë‹¨ê³„ ì´ë¯¸ì§€ ë¡œë”© ì‹œìŠ¤í…œì´ ì„±ê³µì ìœ¼ë¡œ í†µí•©ë˜ì—ˆìŠµë‹ˆë‹¤.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Reddit Devvit Platform                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                               â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Frontend   â”‚ â†â”€â”€â†’ â”‚   Backend    â”‚ â†â”€â”€â†’ â”‚   Redis   â”‚ â”‚
â”‚  â”‚  (React.JS)  â”‚      â”‚  (Express)   â”‚      â”‚    KV     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚         â”‚                      â”‚                             â”‚
â”‚         â”‚                      â”‚                             â”‚
â”‚         â†“                      â†“                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚ 2-Stage Imageâ”‚      â”‚ Gemini AI    â”‚                    â”‚
â”‚  â”‚   Loading    â”‚      â”‚   Service    â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚
â”‚                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## âœ… ì™„ë£Œëœ í•µì‹¬ ê¸°ëŠ¥

### 1. 2ë‹¨ê³„ í”„ë¡œê·¸ë ˆì‹œë¸Œ ì´ë¯¸ì§€ ë¡œë”© ì‹œìŠ¤í…œ

**êµ¬í˜„ ìœ„ì¹˜:**
- `src/client/hooks/useSuspectImages.ts` - ì´ë¯¸ì§€ ë¡œë”© í›…
- `src/client/components/suspect/SuspectPanel.tsx` - UI í†µí•©
- `src/server/index.ts` - `/api/suspect-image/:suspectId` ì—”ë“œí¬ì¸íŠ¸

**ì‘ë™ ë°©ì‹:**

```
Phase 1: ì´ˆê¸° ë¡œë“œ (ë¹ ë¥¸ ì‘ë‹µ)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ GET /api/case/today                 â”‚
â”‚ â†’ ì¼€ì´ìŠ¤ ë°ì´í„° + ìš©ì˜ì ì •ë³´       â”‚
â”‚ â†’ hasProfileImage í”Œë˜ê·¸ë§Œ í¬í•¨     â”‚
â”‚ â†’ ì´ë¯¸ì§€ ë°ì´í„° ì œì™¸ (ë¹ ë¥¸ ë¡œë“œ)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“
Phase 2: ë³‘ë ¬ ì´ë¯¸ì§€ ë¡œë“œ (ë°±ê·¸ë¼ìš´ë“œ)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Promise.allSettled([                â”‚
â”‚   GET /api/suspect-image/suspect-1, â”‚
â”‚   GET /api/suspect-image/suspect-2, â”‚
â”‚   GET /api/suspect-image/suspect-3  â”‚
â”‚ ])                                   â”‚
â”‚ â†’ ê° ì´ë¯¸ì§€ ë…ë¦½ì ìœ¼ë¡œ ë¡œë“œ         â”‚
â”‚ â†’ í•œ ì´ë¯¸ì§€ ì‹¤íŒ¨í•´ë„ ë‹¤ë¥¸ ì´ë¯¸ì§€ OKâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ì£¼ìš” íŠ¹ì§•:**
- âœ… **ë³‘ë ¬ fetching**: 3ê°œ ì´ë¯¸ì§€ ë™ì‹œ ë¡œë“œ (~5ì´ˆ)
- âœ… **ì§€ëŠ¥ì  ìºì‹±**: ì¬ë Œë”ë§ ì‹œ ì¬ìš”ì²­ ë°©ì§€ (`fetchedSuspectsRef`)
- âœ… **ì—ëŸ¬ ë³µì›ë ¥**: í•œ ì´ë¯¸ì§€ ì‹¤íŒ¨í•´ë„ ê²Œì„ ê³„ì† ì§„í–‰
- âœ… **ë¡œë”© UI**: ìŠ¤ì¼ˆë ˆí†¤ ë¡œë” â†’ í˜ì´ë“œì¸ ì• ë‹ˆë©”ì´ì…˜ â†’ í”Œë ˆì´ìŠ¤í™€ë”
- âœ… **Cleanup**: AbortControllerë¡œ ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€

**ì½”ë“œ ì˜ˆì‹œ:**
```typescript
// useSuspectImages.ts
export function useSuspectImages(suspects: Suspect[]): UseSuspectImagesReturn {
  const [images, setImages] = useState<SuspectImagesMap>(new Map());
  const fetchedSuspectsRef = useRef<Set<string>>(new Set());
  
  // ë³‘ë ¬ fetching with Promise.allSettled
  const fetchPromises = suspectsToFetch.map(async (suspect) => {
    const response = await fetch(`/api/suspect-image/${suspect.id}`);
    return { suspectId: suspect.id, imageUrl: data.profileImageUrl };
  });
  
  const results = await Promise.allSettled(fetchPromises);
}
```

### 2. Backend ì‹œìŠ¤í…œ

**ì¼€ì´ìŠ¤ ìƒì„± & ê´€ë¦¬:**
```typescript
// íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ë°˜ ê³ ìœ  ì¼€ì´ìŠ¤ ID
const customCaseId = `case-${dateStr}-${timestamp}`;

// ìš©ì˜ì í”„ë¡œí•„ ì´ë¯¸ì§€ ìˆœì°¨ ìƒì„± (rate limiting ìš°íšŒ)
for (let i = 0; i < suspects.length; i++) {
  await geminiClient.generateImage(prompt);
}
```

**ì£¼ìš” API ì—”ë“œí¬ì¸íŠ¸:**

| ì—”ë“œí¬ì¸íŠ¸ | ë©”ì„œë“œ | ì„¤ëª… | ìƒíƒœ |
|-----------|--------|------|------|
| `/api/case/generate` | POST | ì¼€ì´ìŠ¤ ìƒì„± | âœ… |
| `/api/case/regenerate` | POST | ì´ë¯¸ì§€ ì—†ëŠ” ì¼€ì´ìŠ¤ ì¬ìƒì„± | âœ… |
| `/api/create-game-post` | POST | ìë™ Reddit í¬ìŠ¤íŠ¸ ìƒì„± | âœ… |
| `/api/case/today` | GET | ì˜¤ëŠ˜ì˜ ì¼€ì´ìŠ¤ (ìë™ ì¬ìƒì„±) | âœ… |
| `/api/case/:caseId` | GET | íŠ¹ì • ì¼€ì´ìŠ¤ ë¡œë“œ | âœ… |
| `/api/suspect-image/:suspectId` | GET | ê°œë³„ ì´ë¯¸ì§€ ì¡°íšŒ | âœ… |
| `/api/chat/:suspectId` | POST | AI ëŒ€í™” | âœ… |
| `/api/submit` | POST | ë‹µì•ˆ ì œì¶œ & ì±„ì  | âœ… |
| `/api/leaderboard/:caseId` | GET | ë¦¬ë”ë³´ë“œ ì¡°íšŒ | âœ… |
| `/internal/menu/post-create` | POST | Devvit ë©”ë‰´ í†µí•© | âœ… |

**ìë™ ì¬ìƒì„± ë¡œì§:**
```typescript
// /api/case/today ì—”ë“œí¬ì¸íŠ¸ì—ì„œ ìë™ ì‹¤í–‰
if (fullSuspects.length > 0 && suspectsWithImages.length === 0) {
  console.log('ğŸ”„ Auto-regenerating case with images...');
  await CaseRepository.deleteCase(todaysCase.id);
  const regeneratedCase = await caseGenerator.generateCase({
    includeSuspectImages: true
  });
}
```

### 3. Frontend ê²Œì„ í”Œë¡œìš°

**5ê°œ í™”ë©´ êµ¬ì¡°:**

```
1. Loading Screen (ë¡œë”©)
   - ì¼€ì´ìŠ¤ ë°ì´í„° ë¡œë“œ
   - ì—ëŸ¬ ì²˜ë¦¬ & ì¬ì‹œë„
   â†“
2. Case Overview (ì‚¬ê±´ ê°œìš”)
   - í”¼í•´ì ì •ë³´
   - ì‚¬ê±´ ì¥ì†Œ
   - ë¬´ê¸° ì •ë³´
   - "ìˆ˜ì‚¬ ì‹œì‘" ë²„íŠ¼
   â†“
3. Investigation (ìˆ˜ì‚¬)
   - ìš©ì˜ì íŒ¨ë„ (2ë‹¨ê³„ ì´ë¯¸ì§€ ë¡œë”©)
   - ìš©ì˜ì ì„ íƒ
   - AI ëŒ€í™” ì¸í„°í˜ì´ìŠ¤
   - "ë‹µì•ˆ ì œì¶œí•˜ê¸°" ë²„íŠ¼
   â†“
4. Submission (ë‹µì•ˆ ì œì¶œ)
   - 5W1H ë‹µì•ˆ ì‘ì„±
   - WHO, WHAT, WHERE, WHEN, WHY, HOW
   - "ì œì¶œ" ë²„íŠ¼
   â†“
5. Results (ê²°ê³¼)
   - ì±„ì  ê²°ê³¼
   - ì •ë‹µ ê³µê°œ
   - ë¦¬ë”ë³´ë“œ
   - "ìƒˆ ê²Œì„ ì‹œì‘" ë²„íŠ¼
```

**ì£¼ìš” ì»´í¬ë„ŒíŠ¸:**

| ì»´í¬ë„ŒíŠ¸ | íŒŒì¼ | ì—­í•  | ìƒíƒœ |
|---------|------|------|------|
| App | `src/client/App.tsx` | ë©”ì¸ ì•±, í™”ë©´ ë¼ìš°íŒ… | âœ… |
| CaseOverview | `src/client/components/case/CaseOverview.tsx` | ì‚¬ê±´ ê°œìš” | âœ… |
| SuspectPanel | `src/client/components/suspect/SuspectPanel.tsx` | ìš©ì˜ì íŒ¨ë„ (2ë‹¨ê³„ ì´ë¯¸ì§€) | âœ… |
| ChatInterface | `src/client/components/chat/ChatInterface.tsx` | AI ëŒ€í™” | âœ… |
| SubmissionForm | `src/client/components/submission/SubmissionForm.tsx` | ë‹µì•ˆ ì œì¶œ | âœ… |
| ResultView | `src/client/components/results/ResultView.tsx` | ì±„ì  ê²°ê³¼ | âœ… |

**ì£¼ìš” Hooks:**

| Hook | íŒŒì¼ | ì—­í•  | ìƒíƒœ |
|------|------|------|------|
| useCase | `src/client/hooks/useCase.ts` | ì¼€ì´ìŠ¤ ë°ì´í„° ê´€ë¦¬ | âœ… |
| useSuspectImages | `src/client/hooks/useSuspectImages.ts` | 2ë‹¨ê³„ ì´ë¯¸ì§€ ë¡œë”© | âœ… |
| useSuspect | `src/client/hooks/useSuspect.ts` | ìš©ì˜ì ì„ íƒ ê´€ë¦¬ | âœ… |
| useChat | `src/client/hooks/useChat.ts` | AI ëŒ€í™” ê´€ë¦¬ | âœ… |
| useSubmission | `src/client/hooks/useSubmission.ts` | ë‹µì•ˆ ì œì¶œ ê´€ë¦¬ | âœ… |

### 4. Scripts & Automation

**ìœ í‹¸ë¦¬í‹° ìŠ¤í¬ë¦½íŠ¸:**

| ìŠ¤í¬ë¦½íŠ¸ | íŒŒì¼ | ìš©ë„ | ìƒíƒœ |
|---------|------|------|------|
| create-game-post | `scripts/create-game-post.ts` | ìë™ ê²Œì„ í¬ìŠ¤íŠ¸ ìƒì„± | âœ… |
| regenerate-case | `scripts/regenerate-case-with-images.ts` | ì¼€ì´ìŠ¤ ë³µêµ¬ | âœ… |
| force-regenerate | `scripts/force-regenerate-case.ts` | ê°•ì œ ì¬ìƒì„± | âœ… |

**npm ìŠ¤í¬ë¦½íŠ¸:**
```json
{
  "create-game-post": "tsx scripts/create-game-post.ts",
  "regenerate-case": "tsx scripts/regenerate-case-with-images.ts",
  "force-regenerate": "tsx scripts/force-regenerate-case.ts"
}
```

**Devvit ë©”ë‰´ í†µí•©:**
```json
// devvit.json
{
  "menu": {
    "items": [
      {
        "label": "Create New Game",
        "location": "subreddit",
        "forUserType": "moderator",
        "onPress": {
          "type": "http",
          "url": "/internal/menu/post-create"
        }
      }
    ]
  }
}
```

## ğŸ¯ ê²Œì„ í”Œë¡œìš° ìƒì„¸

### ì‚¬ìš©ì ê²½í—˜ (UX)

```
1. ì‚¬ìš©ìê°€ Reddit í¬ìŠ¤íŠ¸ í´ë¦­
   â†“
2. ë¡œë”© í™”ë©´ (1-2ì´ˆ)
   - "ì‚¬ê±´ íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."
   - ì¼€ì´ìŠ¤ ë°ì´í„° ë¡œë“œ (ì´ë¯¸ì§€ ì œì™¸)
   â†“
3. ì¼€ì´ìŠ¤ ê°œìš” í™”ë©´
   - í”¼í•´ì ì •ë³´ í‘œì‹œ
   - ì‚¬ê±´ ì¥ì†Œ ë° ë¬´ê¸° ì •ë³´
   - "ìˆ˜ì‚¬ ì‹œì‘" ë²„íŠ¼ í´ë¦­
   â†“
4. ìˆ˜ì‚¬ í™”ë©´
   - ìš©ì˜ì 3ëª… í‘œì‹œ
   - ì´ë¯¸ì§€ ë¡œë”© (ë°±ê·¸ë¼ìš´ë“œ, 5ì´ˆ)
     * ìŠ¤ì¼ˆë ˆí†¤ ë¡œë” â†’ ì´ë¯¸ì§€ í˜ì´ë“œì¸
   - ìš©ì˜ì ì„ íƒ â†’ AI ëŒ€í™” ì‹œì‘
   - ì—¬ëŸ¬ ìš©ì˜ìì™€ ëŒ€í™” ê°€ëŠ¥
   - "ë‹µì•ˆ ì œì¶œí•˜ê¸°" ë²„íŠ¼ í´ë¦­
   â†“
5. ë‹µì•ˆ ì œì¶œ í™”ë©´
   - 5W1H í¼ ì‘ì„±
   - WHO: ë²”ì¸ ì„ íƒ (ë“œë¡­ë‹¤ìš´)
   - WHAT, WHERE, WHEN, WHY, HOW: í…ìŠ¤íŠ¸ ì…ë ¥
   - "ì œì¶œ" ë²„íŠ¼ í´ë¦­
   â†“
6. ê²°ê³¼ í™”ë©´
   - ì±„ì  ê²°ê³¼ í‘œì‹œ
   - ì •ë‹µ ê³µê°œ
   - ë¦¬ë”ë³´ë“œ í‘œì‹œ
   - "ìƒˆ ê²Œì„ ì‹œì‘" ë²„íŠ¼
```

### ë°ì´í„° íë¦„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ì‚¬ìš©ì ì•¡ì…˜                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Frontend (React.JS)                         â”‚
â”‚                                                               â”‚
â”‚  useCase Hook                                                â”‚
â”‚  â”œâ”€ GET /api/case/today                                     â”‚
â”‚  â””â”€ ì¼€ì´ìŠ¤ ë°ì´í„° ìˆ˜ì‹  (ì´ë¯¸ì§€ ì œì™¸)                        â”‚
â”‚                                                               â”‚
â”‚  useSuspectImages Hook (ë³‘ë ¬ ì‹¤í–‰)                          â”‚
â”‚  â”œâ”€ GET /api/suspect-image/suspect-1                        â”‚
â”‚  â”œâ”€ GET /api/suspect-image/suspect-2                        â”‚
â”‚  â””â”€ GET /api/suspect-image/suspect-3                        â”‚
â”‚                                                               â”‚
â”‚  useChat Hook                                                â”‚
â”‚  â””â”€ POST /api/chat/:suspectId                               â”‚
â”‚                                                               â”‚
â”‚  useSubmission Hook                                          â”‚
â”‚  â””â”€ POST /api/submit                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Backend (Express)                           â”‚
â”‚                                                               â”‚
â”‚  CaseRepository                                              â”‚
â”‚  â”œâ”€ getTodaysCase()                                         â”‚
â”‚  â”œâ”€ getCaseSuspects()                                       â”‚
â”‚  â””â”€ getSuspectById()                                        â”‚
â”‚                                                               â”‚
â”‚  SuspectAIService                                            â”‚
â”‚  â””â”€ generateResponse() â†’ Gemini AI                          â”‚
â”‚                                                               â”‚
â”‚  ScoringEngine                                               â”‚
â”‚  â””â”€ scoreSubmission() â†’ W4HValidator                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  Redis KV Store                              â”‚
â”‚                                                               â”‚
â”‚  case:{caseId}                                               â”‚
â”‚  suspect:{suspectId}                                         â”‚
â”‚  conversation:{suspectId}:{userId}                           â”‚
â”‚  submission:{userId}:{caseId}                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‹ ì™„ë£Œëœ ê¸°ëŠ¥ ì²´í¬ë¦¬ìŠ¤íŠ¸

### Backend (ì„œë²„)
- âœ… íƒ€ì„ìŠ¤íƒ¬í”„ ê¸°ë°˜ ê³ ìœ  ì¼€ì´ìŠ¤ ìƒì„±
- âœ… customCaseId íŒŒë¼ë¯¸í„° ì§€ì›
- âœ… ìš©ì˜ì í”„ë¡œí•„ ì´ë¯¸ì§€ ìˆœì°¨ ìƒì„± (rate limiting ìš°íšŒ)
- âœ… ìë™ ì¼€ì´ìŠ¤ ì¬ìƒì„± (ì´ë¯¸ì§€ ì—†ì„ ë•Œ)
- âœ… ì¼€ì´ìŠ¤ë³„ ë…ë¦½ì  ê²Œì„ ì§€ì› (postData.caseId)
- âœ… AI ëŒ€í™” ì‹œìŠ¤í…œ (Gemini)
- âœ… ë‹µì•ˆ ì±„ì  ì‹œìŠ¤í…œ (5W1H)
- âœ… ë¦¬ë”ë³´ë“œ ì‹œìŠ¤í…œ
- âœ… Devvit ë©”ë‰´ í†µí•©

### Frontend (í´ë¼ì´ì–¸íŠ¸)
- âœ… 2ë‹¨ê³„ í”„ë¡œê·¸ë ˆì‹œë¸Œ ì´ë¯¸ì§€ ë¡œë”©
- âœ… ë³‘ë ¬ ì´ë¯¸ì§€ fetching (Promise.allSettled)
- âœ… ì§€ëŠ¥ì  ìºì‹± (ì¬ë Œë”ë§ ë°©ì§€)
- âœ… ì—ëŸ¬ ë³µì›ë ¥ (í•œ ì´ë¯¸ì§€ ì‹¤íŒ¨í•´ë„ ê³„ì†)
- âœ… ë¡œë”© UI (ìŠ¤ì¼ˆë ˆí†¤ â†’ í˜ì´ë“œì¸ â†’ í”Œë ˆì´ìŠ¤í™€ë”)
- âœ… 5ê°œ í™”ë©´ ê²Œì„ í”Œë¡œìš°
- âœ… ìš©ì˜ì ì„ íƒ ë° ëŒ€í™” ì‹œìŠ¤í…œ
- âœ… ë‹µì•ˆ ì œì¶œ í¼ (5W1H)
- âœ… ì±„ì  ê²°ê³¼ í‘œì‹œ
- âœ… ì—ëŸ¬ ì²˜ë¦¬ ë° ì¬ì‹œë„ ë¡œì§

### Scripts & Configuration
- âœ… ìë™ ê²Œì„ í¬ìŠ¤íŠ¸ ìƒì„± ìŠ¤í¬ë¦½íŠ¸
- âœ… ì¼€ì´ìŠ¤ ë³µêµ¬ ìŠ¤í¬ë¦½íŠ¸
- âœ… ê°•ì œ ì¬ìƒì„± ìŠ¤í¬ë¦½íŠ¸
- âœ… npm ìŠ¤í¬ë¦½íŠ¸ ì¶”ê°€
- âœ… Devvit ë©”ë‰´ ì„¤ì •

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### 1. ê¸°ë³¸ ê²Œì„ í”Œë¡œìš° í…ŒìŠ¤íŠ¸
```bash
# 1. ê°œë°œ ì„œë²„ ì‹œì‘
npm run dev

# 2. ë¸Œë¼ìš°ì €ì—ì„œ í…ŒìŠ¤íŠ¸
# - ì¼€ì´ìŠ¤ ë¡œë“œ í™•ì¸
# - ì´ë¯¸ì§€ ë¡œë”© í™•ì¸ (ìŠ¤ì¼ˆë ˆí†¤ â†’ ì´ë¯¸ì§€)
# - ìš©ì˜ì ì„ íƒ ë° ëŒ€í™”
# - ë‹µì•ˆ ì œì¶œ
# - ê²°ê³¼ í™•ì¸
```

### 2. ì´ë¯¸ì§€ ë¡œë”© í…ŒìŠ¤íŠ¸
```typescript
// í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤:
// 1. ëª¨ë“  ì´ë¯¸ì§€ ì„±ê³µ ë¡œë“œ
// 2. í•œ ì´ë¯¸ì§€ ì‹¤íŒ¨ (ë‹¤ë¥¸ ì´ë¯¸ì§€ëŠ” ê³„ì†)
// 3. ëª¨ë“  ì´ë¯¸ì§€ ì‹¤íŒ¨ (í”Œë ˆì´ìŠ¤í™€ë” í‘œì‹œ)
// 4. ì¬ë Œë”ë§ ì‹œ ì¬ìš”ì²­ ì•ˆ í•¨ (ìºì‹±)
```

### 3. ì¼€ì´ìŠ¤ ìƒì„± í…ŒìŠ¤íŠ¸
```bash
# ìƒˆ ê²Œì„ í¬ìŠ¤íŠ¸ ìƒì„±
npm run create-game-post

# ì¼€ì´ìŠ¤ ì¬ìƒì„± (ì´ë¯¸ì§€ ì—†ì„ ë•Œ)
npm run regenerate-case

# ê°•ì œ ì¬ìƒì„±
npm run force-regenerate
```

### 4. ì—ëŸ¬ ì²˜ë¦¬ í…ŒìŠ¤íŠ¸
```typescript
// í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤:
// 1. ì¼€ì´ìŠ¤ ì—†ì„ ë•Œ â†’ ìë™ ìƒì„±
// 2. ìš©ì˜ì ì—†ì„ ë•Œ â†’ ì—ëŸ¬ í™”ë©´ + ì¬ìƒì„± ë²„íŠ¼
// 3. ì´ë¯¸ì§€ ë¡œë“œ ì‹¤íŒ¨ â†’ í”Œë ˆì´ìŠ¤í™€ë” í‘œì‹œ
// 4. AI ëŒ€í™” ì‹¤íŒ¨ â†’ ì—ëŸ¬ ë©”ì‹œì§€
// 5. ë‹µì•ˆ ì œì¶œ ì‹¤íŒ¨ â†’ ì—ëŸ¬ ë©”ì‹œì§€
```

## ğŸš€ ë°°í¬ ì¤€ë¹„ ìƒíƒœ

### í”„ë¡œë•ì…˜ ì²´í¬ë¦¬ìŠ¤íŠ¸
- âœ… TypeScript ì»´íŒŒì¼ ì—ëŸ¬ ì—†ìŒ
- âœ… ESLint ê²½ê³  ì—†ìŒ
- âœ… ëª¨ë“  API ì—”ë“œí¬ì¸íŠ¸ ì‘ë™
- âœ… 2ë‹¨ê³„ ì´ë¯¸ì§€ ë¡œë”© ì‘ë™
- âœ… ì—ëŸ¬ ì²˜ë¦¬ ì™„ë£Œ
- âœ… ë©”ëª¨ë¦¬ ëˆ„ìˆ˜ ë°©ì§€ (AbortController)
- âœ… Devvit ë©”ë‰´ í†µí•©
- âœ… Redis KV ì €ì¥ì†Œ ì—°ë™

### ë°°í¬ ëª…ë ¹ì–´
```bash
# ë¹Œë“œ
npm run build

# Devvit ë°°í¬
npm run deploy

# í¼ë¸”ë¦¬ì‹œ (ë¦¬ë·°ìš©)
npm run launch
```

## ğŸ“ˆ ì„±ëŠ¥ ì§€í‘œ

### ë¡œë”© ì‹œê°„
- **ì´ˆê¸° ì¼€ì´ìŠ¤ ë¡œë“œ**: ~1-2ì´ˆ (ì´ë¯¸ì§€ ì œì™¸)
- **ì´ë¯¸ì§€ ë¡œë“œ (ë³‘ë ¬)**: ~5ì´ˆ (3ê°œ ì´ë¯¸ì§€)
- **AI ëŒ€í™” ì‘ë‹µ**: ~2-3ì´ˆ
- **ë‹µì•ˆ ì±„ì **: ~3-5ì´ˆ

### ë°ì´í„° í¬ê¸°
- **ì¼€ì´ìŠ¤ ë°ì´í„°**: ~5KB (ì´ë¯¸ì§€ ì œì™¸)
- **ìš©ì˜ì ì´ë¯¸ì§€**: ~50-100KB/ê°œ (base64)
- **ì „ì²´ í˜ì´ë¡œë“œ**: ~200-300KB

### ìµœì í™” í¬ì¸íŠ¸
- âœ… ì´ë¯¸ì§€ ë¶„ë¦¬ ë¡œë“œ (500 ì—ëŸ¬ ë°©ì§€)
- âœ… ë³‘ë ¬ fetching (ì†ë„ í–¥ìƒ)
- âœ… ì§€ëŠ¥ì  ìºì‹± (ì¬ìš”ì²­ ë°©ì§€)
- âœ… AbortController (ë©”ëª¨ë¦¬ ê´€ë¦¬)

## ğŸ”® í–¥í›„ ê°œì„  ì‚¬í•­

### ìš°ì„ ìˆœìœ„ ë†’ìŒ
1. **ë‹¤êµ­ì–´ ì§€ì›**
   - í˜„ì¬: `language` íŒŒë¼ë¯¸í„° ìˆì§€ë§Œ ë¯¸ì‚¬ìš©
   - ëª©í‘œ: í•œêµ­ì–´/ì˜ì–´ ì™„ì „ ì§€ì›

2. **ëª¨ë°”ì¼ ìµœì í™”**
   - í˜„ì¬: ë°ìŠ¤í¬í†± ì¤‘ì‹¬
   - ëª©í‘œ: ë°˜ì‘í˜• ë””ìì¸ ê°œì„ 

3. **ë¦¬ë”ë³´ë“œ UI**
   - í˜„ì¬: APIë§Œ ìˆìŒ
   - ëª©í‘œ: ê²°ê³¼ í™”ë©´ì— í†µí•©

### ìš°ì„ ìˆœìœ„ ì¤‘ê°„
4. **ì¼€ì´ìŠ¤ í†µê³„**
   - í”Œë ˆì´ íšŸìˆ˜, ì •ë‹µë¥  ë“±

5. **ì†Œì…œ ê³µìœ **
   - ê²°ê³¼ ê³µìœ  ê¸°ëŠ¥

6. **íŒíŠ¸ ì‹œìŠ¤í…œ**
   - ì¼ì • ì‹œê°„ í›„ íŒíŠ¸ ì œê³µ

### ìš°ì„ ìˆœìœ„ ë‚®ìŒ
7. **í…Œë§ˆ ì»¤ìŠ¤í„°ë§ˆì´ì§•**
8. **ì‚¬ìš´ë“œ íš¨ê³¼**
9. **ì• ë‹ˆë©”ì´ì…˜ ê°•í™”**

## ğŸ“š ê´€ë ¨ ë¬¸ì„œ

### ê¸°ìˆ  ë¬¸ì„œ
- `docs/ai-chat-integration-guide.md` - AI ì±„íŒ… í†µí•© ê°€ì´ë“œ
- `TESTING_GUIDE.md` - í…ŒìŠ¤íŠ¸ ê°€ì´ë“œ
- `.env.template` - í™˜ê²½ ë³€ìˆ˜ í…œí”Œë¦¿

### ì•„í‚¤í…ì²˜ ë¬¸ì„œ
- `doc.md/ìµœì¢…ì•„í‚¤í…ì²˜-í™•ì •.md` - ìµœì¢… ì•„í‚¤í…ì²˜
- `doc.md/í•µì‹¬ìš”ì†Œê°œë°œ.md` - í•µì‹¬ ìš”ì†Œ ê°œë°œ

### Spec ë¬¸ì„œ
- `.kiro/specs/suspect-image-display/` - ìš©ì˜ì ì´ë¯¸ì§€ í‘œì‹œ Spec
- `.kiro/specs/data-consistency-fix/` - ë°ì´í„° ì¼ê´€ì„± ìˆ˜ì • Spec
- `.kiro/specs/location-evidence-system/` - ì¥ì†Œ ì¦ê±° ì‹œìŠ¤í…œ Spec

## ğŸ“ í•™ìŠµ í¬ì¸íŠ¸

### ì„±ê³µí•œ íŒ¨í„´
1. **2ë‹¨ê³„ ë¡œë”©**: ì´ˆê¸° ë¡œë“œ ë¹ ë¥´ê²Œ + ë°±ê·¸ë¼ìš´ë“œ ì´ë¯¸ì§€ ë¡œë“œ
2. **Promise.allSettled**: ë³‘ë ¬ ì²˜ë¦¬ + ì—ëŸ¬ ë³µì›ë ¥
3. **ì§€ëŠ¥ì  ìºì‹±**: useRefë¡œ ì¬ìš”ì²­ ë°©ì§€
4. **íƒ€ì„ìŠ¤íƒ¬í”„ ì¼€ì´ìŠ¤ ID**: ê° í¬ìŠ¤íŠ¸ë§ˆë‹¤ ë…ë¦½ì  ê²Œì„

### í”¼í•´ì•¼ í•  íŒ¨í„´
1. âŒ ì´ˆê¸° ë¡œë“œì— ëª¨ë“  ì´ë¯¸ì§€ í¬í•¨ (500 ì—ëŸ¬)
2. âŒ Promise.all ì‚¬ìš© (í•œ ì‹¤íŒ¨ ì‹œ ì „ì²´ ì‹¤íŒ¨)
3. âŒ ìºì‹± ì—†ì´ ì¬ë Œë”ë§ë§ˆë‹¤ ì¬ìš”ì²­
4. âŒ ë‚ ì§œ ê¸°ë°˜ ì¼€ì´ìŠ¤ ID (í•˜ë£¨ì— í•˜ë‚˜ë§Œ)

## ğŸ“ ì§€ì› ë° ë¬¸ì˜

### ê°œë°œíŒ€
- **í”„ë¡œì íŠ¸**: Armchair Sleuths
- **í”Œë«í¼**: Reddit Devvit
- **ê¸°ìˆ  ìŠ¤íƒ**: React.JS, Express, Redis, Gemini AI

### ë¬¸ì œ ë³´ê³ 
- GitHub Issues
- Reddit ëª¨ë”ë ˆì´í„° ë©”ì‹œì§€

---

**ë¬¸ì„œ ë²„ì „**: 1.0  
**ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸**: 2025-01-15  
**ë‹¤ìŒ ë¦¬ë·°**: 2025-02-01
